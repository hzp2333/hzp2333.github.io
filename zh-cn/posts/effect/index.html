<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>因果效应 - 滑翔闪&#39;S BLOG</title><meta name="Description" content=""><meta property="og:title" content="因果效应" />
<meta property="og:description" content="本文是因果推断方法识别效应学习笔记，介绍ATE、ATT、RCT、ITT、LATE的关系" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.huaxiangshan.com/zh-cn/posts/effect/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-02-28T18:27:40+08:00" />
<meta property="article:modified_time" content="2024-02-28T18:27:40+08:00" />

<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="因果效应"/>
<meta name="twitter:description" content="本文是因果推断方法识别效应学习笔记，介绍ATE、ATT、RCT、ITT、LATE的关系"/>
<meta name="application-name" content="滑翔闪&#39;S BLOG">
<meta name="apple-mobile-web-app-title" content="滑翔闪&#39;S BLOG"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://blog.huaxiangshan.com/zh-cn/posts/effect/" /><link rel="prev" href="https://blog.huaxiangshan.com/zh-cn/posts/sss/" /><link rel="next" href="https://blog.huaxiangshan.com/zh-cn/posts/h/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "因果效应",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/blog.huaxiangshan.com\/zh-cn\/posts\/effect\/"
        },"genre": "posts","keywords": "文献阅读, 因果效应","wordcount":  4555 ,
        "url": "https:\/\/blog.huaxiangshan.com\/zh-cn\/posts\/effect\/","datePublished": "2024-02-28T18:27:40+08:00","dateModified": "2024-02-28T18:27:40+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "滑翔闪"},"author": {
                "@type": "Person",
                "name": "滑翔闪"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="" data-header-mobile=""><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper">
<script>
  MathJax = {
    tex: {
      inlineMath: [["$", "$"]],
    },
    displayMath: [
      ["$$", "$$"],
      ["\[\[", "\]\]"],
    ],
    svg: {
      fontCache: "global",
    },
  };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
></script>


<a href="https://www.travellings.cn/go.html" target="_blank" rel="noopener" title="开往-友链接力">
    <img src="https://www.travellings.cn/assets/logo.gif" alt="开往-友链接力" width="120">
</a>


<script type="text/javascript" src="https://www.liuzehe.top/upload/bkjs/meme.js"></script>
<canvas class="fireworks" style="position:fixed;left:0;top:0;z-index:99999999;pointer-events:none;"></canvas>
<script type="text/javascript" src="https://www.liuzehe.top/upload/bkjs/anime.min.js"></script>
<script type="text/javascript" src="https://www.liuzehe.top/upload/bkjs/fireworks.js"></script> 

<script defer src="https://cdn.jsdelivr.net/npm/akilar-live2d-widget/autoload.min.js"></script>


<script type="text/javascript" color="0,174,255" opacity='0.7' zIndex="-2" count="200" src="https://www.liuzehe.top/upload/bkjs/bj.js"></script>


<script src="/js/yh.js"></script><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/zh-cn/" title="滑翔闪&#39;S BLOG"><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/zh-cn/posts/" title="书中自有黄金屋"><i class='fa fa-solid fa-book'></i> 文章 </a><a class="menu-item" href="/zh-cn/tags/" title="定义文章，不定义世界"><i class='fa fa-tag'></i> 标签 </a><a class="menu-item" href="/zh-cn/categories/" title="分类是种视角"><i class='fa fa-archive'></i> 分类 </a><a class="menu-item" href="/zh-cn/friends/" title="有朋自远方来"><i class='fa fa-user-group'></i> 友链  </a><a class="menu-item" href="https://www.travellings.cn/go.html" title="漫长的列车驶向未来" rel="noopener noreffer" target="_blank"><i class='fa fa-train-subway'></i> 开往  </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item language" title="选择语言">简体中文<i class="fas fa-chevron-right fa-fw" aria-hidden="true"></i>
                        <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/zh-cn/posts/effect/" selected>简体中文</option><option value="/en/posts/effect/">English</option></select>
                    </a><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/zh-cn/" title="滑翔闪&#39;S BLOG"><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/zh-cn/posts/" title="书中自有黄金屋"><i class='fa fa-solid fa-book'></i>文章</a><a class="menu-item" href="/zh-cn/tags/" title="定义文章，不定义世界"><i class='fa fa-tag'></i>标签</a><a class="menu-item" href="/zh-cn/categories/" title="分类是种视角"><i class='fa fa-archive'></i>分类</a><a class="menu-item" href="/zh-cn/friends/" title="有朋自远方来"><i class='fa fa-user-group'></i>友链 </a><a class="menu-item" href="https://www.travellings.cn/go.html" title="漫长的列车驶向未来" rel="noopener noreffer" target="_blank"><i class='fa fa-train-subway'></i>开往 </a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="选择语言">简体中文<i class="fas fa-chevron-right fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/zh-cn/posts/effect/" selected>简体中文</option><option value="/en/posts/effect/">English</option></select>
                </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">因果效应</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://github.com/hzp2333/hzp2333.github.io" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>滑翔闪</a>
</span>&nbsp;<span class="post-category">类别 <a href="/zh-cn/categories/%E7%BB%8F%E6%B5%8E%E5%AD%A6%E4%B9%A0/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>经济学习</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2024-02-28">2024-02-28</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;约 4555 字&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;预计阅读 10 分钟&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/1a%20%281%29.jpg"
        data-srcset="/img/1a%20%281%29.jpg, /img/1a%20%281%29.jpg 1.5x, /img/1a%20%281%29.jpg 2x"
        data-sizes="auto"
        alt="/img/1a (1).jpg"
        title="/img/1a (1).jpg" /></div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#从ate到att">从ATE到ATT</a></li>
    <li><a href="#rct让ate趋近att">RCT：让ATE趋近ATT</a></li>
    <li><a href="#从itt到late">从ITT到LATE</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><meting-js server="netease" type="song" id="1833805540" theme="#448aff"></meting-js>
<p>最近《世界经济》期刊线上活动讲座上，刘若鸿老师介绍了他的论文《工业用地价格与企业产能利用率》<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> 。分析框架借鉴了陈钊老师等人（2021）发在AER上的论文《Notching R&amp;D investment with corporate income tax cuts in China》 <sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>——使用聚束（bunching）方法研究经济现象。</p>
<blockquote>
<p>《世界经济》官网已经可以下载论文代码数据量。手把手活动系列视频也可以在B站找到录播。听论文作者讲诉自己在选题、文献阅读、方法选择、修改稿件的心路历程，确实受益匪浅！</p>
</blockquote>
<p>
<figure><a class="lightgallery" href="/img/v2-83ee19c6e4f74f71f0b3b2e5a77122c4_720w.jpeg" title="左刘若鸿老师论文截图，右陈钊老师论文截图。有点类似RDD，但是因为这类政策样本不满足随机干预，是一种政策集聚现象，所以采用群聚分析" data-thumbnail="/img/v2-83ee19c6e4f74f71f0b3b2e5a77122c4_720w.jpeg" data-sub-html="<h2> </h2><p>左刘若鸿老师论文截图，右陈钊老师论文截图。有点类似RDD，但是因为这类政策样本不满足随机干预，是一种政策集聚现象，所以采用群聚分析</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/v2-83ee19c6e4f74f71f0b3b2e5a77122c4_720w.jpeg"
            data-srcset="/img/v2-83ee19c6e4f74f71f0b3b2e5a77122c4_720w.jpeg, /img/v2-83ee19c6e4f74f71f0b3b2e5a77122c4_720w.jpeg 1.5x, /img/v2-83ee19c6e4f74f71f0b3b2e5a77122c4_720w.jpeg 2x"
            data-sizes="auto"
            alt="/img/v2-83ee19c6e4f74f71f0b3b2e5a77122c4_720w.jpeg" />
    </a><figcaption class="image-caption">左刘若鸿老师论文截图，右陈钊老师论文截图。有点类似RDD，但是因为这类政策样本不满足随机干预，是一种政策集聚现象，所以采用群聚分析</figcaption>
    </figure></p>
<p>刘若鸿老师提到学习这部分代码时最好了解下因果推断识别效应。附件的do文件也取名ITT。我发现我竟然对“因果推断方法识别效应”这部分知识印象不深，因此在这里记录下学习过程。</p>
<div class="bilibili"><iframe src="//player.bilibili.com/player.html?bvid=BV1ag4y1e7Bm&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"></iframe></div>

<h1 id="因果框架有哪些" class="headerLink">
    <a href="#%e5%9b%a0%e6%9e%9c%e6%a1%86%e6%9e%b6%e6%9c%89%e5%93%aa%e4%ba%9b" class="header-mark"></a>因果框架有哪些？</h1><p>今因果框架众多，群雄并起，统计学（本家之外，药物学、心理学也各有自家统计理解）、经济学、计算机皆有流派，交错纵横，我也不清楚整个体系到底如何。</p>
<p>个人接触比较多的是Judea Pearl的<strong>结构因果模型</strong>（Structural Causal Model,简称SCM）。对于他的著作《为什么》<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup> ，我个人理解是，关联-干预-反事实就是三个因果层级。控制变量的选用就是控制后门，工具变量的设置就是控制前门。</p>
<p>
<figure><a class="lightgallery" href="/img/v2-ad0a0aa2636df610c723a173bc10c04e_720w.png" title="相关不等于因果，相关性并不讨论方向。因果性是单向的，因此我们要有单向路径图指导。寻找路径后，再通过分析想像出“反事实”的世界。" data-thumbnail="/img/v2-ad0a0aa2636df610c723a173bc10c04e_720w.png" data-sub-html="<h2> </h2><p>相关不等于因果，相关性并不讨论方向。因果性是单向的，因此我们要有单向路径图指导。寻找路径后，再通过分析想像出“反事实”的世界。</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/v2-ad0a0aa2636df610c723a173bc10c04e_720w.png"
            data-srcset="/img/v2-ad0a0aa2636df610c723a173bc10c04e_720w.png, /img/v2-ad0a0aa2636df610c723a173bc10c04e_720w.png 1.5x, /img/v2-ad0a0aa2636df610c723a173bc10c04e_720w.png 2x"
            data-sizes="auto"
            alt="/img/v2-ad0a0aa2636df610c723a173bc10c04e_720w.png" />
    </a><figcaption class="image-caption">相关不等于因果，相关性并不讨论方向。因果性是单向的，因此我们要有单向路径图指导。寻找路径后，再通过分析想像出“反事实”的世界。</figcaption>
    </figure></p>
<p>ATE、ATT、ITT、LATE这部分知识在《基本无害的计量经济学》<sup id="fnref1:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup> 中零散出现。整个框架是基于Donald Rubin提出的<strong>潜在结果框架</strong>(Potential Outcome Framework ，也叫Rubin Causal Model，简称RCM)<strong>。</strong></p>
<blockquote>
<p>有趣的是，Judea Pearl（在《为什么》中）提出因果路径下的反事实就是Rubin提出的&quot;潜在结果&quot;，不过Rubin回应两者完全不是一回事<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>，并且不赞成路径图的分析方法 。 （个人不太能理解rubin的回应，在我个人看来SCM的路径箭头方向对应的就是RCM的加减符号方向）。</p>
</blockquote>
<p>据我所知，目前因果分析在统计学中还分为频率学派、贝叶斯学派，研究通过马尔科夫链去理解因果推断。这方面个人就完全知之甚少了。个人对这块知识的了解完全来自于B站up——Fmajor的科普视频。</p>
<div class="bilibili"><iframe src="//player.bilibili.com/player.html?bvid=BV1Qu4y1j7GS&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"></iframe></div>

<h1 id="细说rcm因果效应" class="headerLink">
    <a href="#%e7%bb%86%e8%af%b4rcm%e5%9b%a0%e6%9e%9c%e6%95%88%e5%ba%94" class="header-mark"></a>细说RCM因果效应</h1><blockquote>
<p>ATE、ATT、ITT、LATE是不同的统计估计量。</p>
</blockquote>
<h2 id="从ate到att" class="headerLink">
    <a href="#%e4%bb%8eate%e5%88%b0att" class="header-mark"></a>从ATE到ATT</h2><p>从小学开始，我们就接触了使用各个数组的均值来进行比较分析。不过这种分组对比只是因果讨论的起点，需要进一步对这种分组差异进行分解，进而探讨因果关系。</p>
<p>$\boxed{平均处理效应}$ （average treatment effect，简称ATE）：<strong>直接用两组数据均值之差</strong>作为估计量。既可以看作总体均值相减，又可以看作分组相减的均值（例如双胞胎数据估计）：</p>
<p>$$\bar Y_1-\bar Y_0=\sum_{i=1}^{N}\frac{Y_{i}(1)-Y_{i}(0)}{N}$$</p>
<p>将$D_i$ 视为处理行为。 $D_i$为1为实验组，为0为对照组。产生线性方程如下：</p>
<p>$$\begin{align}Y_{i}&amp;=\begin{cases} Y_{1i} \quad if D_i = 1 \newline Y_{0i} \quad if D_i = 0 \end{cases} \newline &amp;=Y_{0i}+(Y_{1i}-Y_{0i})D_{i} \end{align}$$</p>
<p>分组相减，可得如下式子（注意红色部分）：</p>
<p>$$\begin{aligned} &amp;\mathbf{E}[Y_{i}\mid D_{i}=1]-\mathbf{E}[Y_{i}\mid D_{i}=0]\newline&amp; =\color{red}{\underbrace{\mathbf{E}\lfloor Y_{1i}\mid D_{i}=1\rfloor-\mathbf{E}[Y_{0i}\mid D_{i}=1]}_{\text{处理的平均处理效应ATT}}  } \newline &amp;+\underbrace{\mathbf{E}[Y_{0i}\mid D_{i}=1]-\mathbf{E}[Y_{0i}\mid D_{i}=0]}_{选择性偏误} \end{aligned}$$</p>
<p>其中$\mathbf{E}[Y_{0i}\mid D_{i}=1]$是我们主动添加的，是想要却无法直接找到的另一个”平行宇宙“——<strong>假如</strong>$\mathbf{E}[Y_{\color{blue}{1i}}\mid D_{i}=1]$部分群体，在平行世界没有没有接受处理，他们的状态表示为 $\mathbf{E}[Y_{\color{blue}{0i}}\mid D_{i}=1]$,也就是Rubin想找到的&quot;潜在结果&quot;。</p>
<p>$\color{red}{\mathbf{E}\lfloor Y_{1i}\mid D_{i}=1\rfloor-\mathbf{E}[Y_{0i}\mid D_{i}=1]}$代表着$\boxed{处理组平均处理效应}$（Average Treatment Effect on Treated，简称ATT）。再没有比“<strong>一个二项选择分裂出两个平行宇宙</strong>”更好的对照试验了，然而没有人能真正获得这种数据！因此，经济学家的做法是想通过ATE来估计ATT，于是引入了随机试验（RCT）。</p>
<h2 id="rct让ate趋近att" class="headerLink">
    <a href="#rct%e8%ae%a9ate%e8%b6%8b%e8%bf%91att" class="header-mark"></a>RCT：让ATE趋近ATT</h2><p>RCT全称为Randomized controlled trial，代表$\boxed{随机试验}$，<strong>在随机试验条件下，ATE=ATT</strong>，接下来展开介绍：</p>
<p>平行世界分裂出的这部分群体$\mathbf{E}[Y_{0i}\mid D_{i}=1]$和现实一开始就没有接受过处理的群体$\operatorname{E}[Y_{0i}\mid D_{i}=0]$相减，如果不为0，就产生了选择性偏差。</p>
<blockquote>
<p>原因可能是<strong>样本选择偏差</strong>：例如我们做健身相关的调查，但只去健身馆收集数据，肯定不能实现有效对比；例如美军著名的飞机幸存者偏差，飞回来的飞机是活下来的飞机，通过他们身上的损伤估计需要加强的部位也是不可靠的；</p>
<p>也可能是<strong>自选择偏差</strong>：例如入学性别比不均不代表歧视，因为这种分析忽略了性别比的申请倾向，某种性别的人更倾向于申请难度更高的，淘汰率也就更高；警察执法更关注某个种族也不代表就是歧视，看看那个种族犯罪频率是不是相对就高一些。</p>
<p><strong>遗漏变量、模型错误、测量错误、样本不足</strong>都可能导致。</p>
</blockquote>
<p><strong>如果我们采用随机试验的方法，样本是随机分布的</strong>。我们希望这种随机试验能把一些我们没观察到的影响变量给平均掉，进而使得$D_i$和$Y_{0i}$具有独立性，这意味着$\mathbf{E}[Y_{0i}\mid D_{i}=1]=\mathbf{E}[Y_{0i}\mid D_{i}=0]=0$。</p>
<p>此时ATE估计得到了有效的简化：</p>
<p>$$\begin{aligned} &amp;\mathbf{E}[Y_{1i}\mid D_{i}=1]-\mathbf{E}[Y_{0i}\mid D_{i}=1]\newline&amp;=ATT =\mathbf{E}[\mathbf{Y}_{1i}-\mathbf{Y}_{0i}\mid D_{i}=1]  \newline &amp;=ATE=\mathbf{E}[Y_{1i}-Y_{0i}] \end{aligned}$$</p>
<p>进一步通过<strong>回归式子</strong>来估计：</p>
<p>$$\begin{align}Y_{i}&amp;=\begin{cases} Y_{1i} \quad if D_i = 1 \newline Y_{0i} \quad if D_i = 0 \end{cases} \newline &amp;=Y_{0i}+(Y_{1i}-Y_{0i})D_{i}  \newline &amp; =\alpha+\rho D_i+\eta_i  \end{align}$$</p>
<p>由于</p>
<p>$$\begin{aligned}&amp;\operatorname{\mathbf{E}}[Y_i\mid D_i=1]=\alpha+\rho+\operatorname{\mathbf{E}}[\eta_i\mid D_i=1]\newline &amp;\operatorname{\mathbf{E}}[Y_i\mid D_i=0]=\alpha+\operatorname{\mathbf{E}}[\eta_i\mid D_i=0]\end{aligned}$$</p>
<p>可以得到两者相减</p>
<p>$$\begin{aligned}&amp;\operatorname{\mathbf{E}}[Y_i\mid D_i=1]-\operatorname{\mathbf{E}}[Y_i\mid D_i=0]\newline &amp;=\underbrace{\rho}_\text{处理效应}+\underbrace{\operatorname{\mathbf{E}}[\eta_i\mid D_i=1]-\operatorname{\mathbf{E}}[\eta_i\mid D_i=0]}_\text{选择性偏误}\end{aligned}$$</p>
<p>选择偏差$\eta_i\ne0$时，意味着残差和 $D_i$相关。 我们强调随机试验，就是希望随机干预试验能够使得二者无关，消除这种选择偏差。所以当满足随机试验时，$\eta_i=0$,$ATE\xrightarrow{RCT}ATT$。</p>
<blockquote>
<p>这也告诉了我们为什么要重视残差分析。</p>
</blockquote>
<h2 id="从itt到late" class="headerLink">
    <a href="#%e4%bb%8eitt%e5%88%b0late" class="header-mark"></a>从ITT到LATE</h2><p>$\boxed{意向性分析}$（Intention to treat，简称ITT）。虽然随机干预试验很有用，但我们要研究的变量不总是随机分布的。例如刘若鸿老师的《工业用地价格与企业产能利用率》——研究工业用地集聚在某一档土地等级周围。此时买家们不讲武德，是有备而来，也就不是随机分布的。此时我们考虑其他随机分布的变量会影响他们的决策。</p>
<p>先使用SCM的路径图来理解会更加形象：</p>
<p>
<figure><a class="lightgallery" href="/img/v2-22fc28b2a5f20de868f80f8bd174c72a_720w.png" title="图源：《因果推断实用计量方法 》(邱嘉平)我们想研究的变量D并不随机，于是我们找到了一个随机变量Z，同时Z和D之间具有因果关系。" data-thumbnail="/img/v2-22fc28b2a5f20de868f80f8bd174c72a_720w.png" data-sub-html="<h2> </h2><p>图源：《因果推断实用计量方法 》(邱嘉平)我们想研究的变量D并不随机，于是我们找到了一个随机变量Z，同时Z和D之间具有因果关系。</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/v2-22fc28b2a5f20de868f80f8bd174c72a_720w.png"
            data-srcset="/img/v2-22fc28b2a5f20de868f80f8bd174c72a_720w.png, /img/v2-22fc28b2a5f20de868f80f8bd174c72a_720w.png 1.5x, /img/v2-22fc28b2a5f20de868f80f8bd174c72a_720w.png 2x"
            data-sizes="auto"
            alt="/img/v2-22fc28b2a5f20de868f80f8bd174c72a_720w.png" />
    </a><figcaption class="image-caption">图源：《因果推断实用计量方法 》(邱嘉平)我们想研究的变量D并不随机，于是我们找到了一个随机变量Z，同时Z和D之间具有因果关系。</figcaption>
    </figure></p>
<p>再举例Angrist（2011）<sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup>的一篇论文，研究参加越南战争对收入的影响 ，里面参军变量不好使，就使用了入伍资格作为工具变量。（怀念短短6页的计量论文时代）</p>
<p>
<figure><a class="lightgallery" href="/img/v2-4563670654f5945b5f76df358f0bc575_720w.png" title="论文其实就是用了2SLS" data-thumbnail="/img/v2-4563670654f5945b5f76df358f0bc575_720w.png" data-sub-html="<h2> </h2><p>论文其实就是用了2SLS</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/v2-4563670654f5945b5f76df358f0bc575_720w.png"
            data-srcset="/img/v2-4563670654f5945b5f76df358f0bc575_720w.png, /img/v2-4563670654f5945b5f76df358f0bc575_720w.png 1.5x, /img/v2-4563670654f5945b5f76df358f0bc575_720w.png 2x"
            data-sizes="auto"
            alt="/img/v2-4563670654f5945b5f76df358f0bc575_720w.png" />
    </a><figcaption class="image-caption">论文其实就是用了2SLS</figcaption>
    </figure></p>
<p>显然，存在这样一个过程，一个人先被告知有没有入伍资格，然后他决定是否进入军队。</p>
<p>ITT式子如下所示：</p>
<p>$$ITT=\mathbf{E}[Y_i|Z_i=1]-\mathbf{E}[Y_i|Z_i=0]$$</p>
<p>可以看出ITT估计和 $\mathbf{E}[Y_{i}\mid D_{i}=1]-\mathbf{E}[Y_{i}\mid D_{i}=0]$相当类似，也就是说，<strong>当</strong>$ D_i$ 和 $Z_i$ 一一对应时，也就是$z=d$ 时，<strong>ITT=ATE</strong>。</p>
<ul>
<li>$\pi_N$:无论我有没有资格，我最终都不会参军。</li>
<li>$\pi_D$:逆反心态，有参军资格我偏不去，没有参军资格我偏要去。</li>
<li>$\pi_A$:无论我有没有资格，我最终都会去参军。</li>
<li>$\pi_C$:服从安排，有资格我就去，没资格我就不去。</li>
</ul>
<p>
<figure><a class="lightgallery" href="/img/v2-0552ff134cd3a8753ec35e12234863cf_720w-17091261001656.png" title="图源牛津课件（w4节)：https://andy.egge.rs/teaching/causal_inference/" data-thumbnail="/img/v2-0552ff134cd3a8753ec35e12234863cf_720w-17091261001656.png" data-sub-html="<h2> </h2><p>图源牛津课件（w4节)：https://andy.egge.rs/teaching/causal_inference/</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/v2-0552ff134cd3a8753ec35e12234863cf_720w-17091261001656.png"
            data-srcset="/img/v2-0552ff134cd3a8753ec35e12234863cf_720w-17091261001656.png, /img/v2-0552ff134cd3a8753ec35e12234863cf_720w-17091261001656.png 1.5x, /img/v2-0552ff134cd3a8753ec35e12234863cf_720w-17091261001656.png 2x"
            data-sizes="auto"
            alt="/img/v2-0552ff134cd3a8753ec35e12234863cf_720w-17091261001656.png" />
    </a><figcaption class="image-caption">图源牛津课件（w4节)：https://andy.egge.rs/teaching/causal_inference/</figcaption>
    </figure></p>
<p>同时由于我们本来就是基于军人样本进行统计， $D_i$并非随机分布，因此只有如下式子：</p>
<p>$$\begin{aligned} \mathbf{E}[D_i=1|Z_i=0]=\pi_A+\pi_D\newline \mathbf{E}[D_i=1|Z_i=1]=\pi_A+\pi_C \end{aligned}$$</p>
<p>如此一来肯定不能单独估计出$\pi_i(i\in{A,C,D,N})$了。</p>
<p>不过由于随机分布，结果会成比例，可以变形出线性方程：</p>
<p>$$ITT=\pi_CITT_C+\pi_AITT_A+\pi_NITT_N+\pi_DITT_D$$</p>
<blockquote>
<p><strong>解决办法是增加假设</strong> ——很有经济学笑话味道了。 插入笑话原文：一个物理学家、一个化学家和一个经济学家漂流到孤岛上，十分饥饿。这时海面上漂來一个罐头。物理学家说：“我们可以用岩石对罐头施以动量，使其表层疲劳而断裂。”化学家说：“我们可以生火，然后把罐头加热，使它膨胀以至破裂。”经济学家则说：“假设我们有一个开罐头的起子……。”</p>
</blockquote>
<p>加入假设后，我们就直接得到了LATE：</p>
<p>$$\mathrm{LATE}=\mathrm{CATE}_{\mathcal{C}}=\frac{\mathrm{ITT}}{\pi_{\mathcal{C}}}$$</p>
<p>此时估计如下：</p>
<p>$$\small \hat{\mathbf{CATE}_C}=\frac{\mathbf{E}\Big[Y_i|Z_i=1\Big]-\mathbf{E}\Big[Y_i|Z_i=0\Big]}{\mathbf{E}\Big[D_i|Z_i=1\Big]-\mathbf{E}\Big[D_i|Z_i=0\Big]}=\frac{\mathrm{effect~of~}Z_i\text{ on }Y_i}{\mathrm{effect~of~}Z_i\text{ on }D_i}=\frac{\operatorname{ITT}_Y}{\operatorname{ITT}_D}$$</p>
<p><strong>LATE部分</strong>重点参考了<a href="https://andy.egge.rs/teaching/causal_inference/" target="_blank" rel="noopener noreffer">牛津的课件</a>
，如果想看相对代数化的说明可以参考<a href="https://scholar.harvard.edu/files/apassalacqua/files/section8_ATE_vs_LATE.pdf" target="_blank" rel="noopener noreffer">哈佛的课件</a>
和《基本无害的计量经济学》。</p>
<h1 id="数理经济中的社科属性" class="headerLink">
    <a href="#%e6%95%b0%e7%90%86%e7%bb%8f%e6%b5%8e%e4%b8%ad%e7%9a%84%e7%a4%be%e7%a7%91%e5%b1%9e%e6%80%a7" class="header-mark"></a>数理经济中的社科属性？</h1><p>直接说&quot;解决办法是添加几个假设&quot;未免有些太经济学地狱笑话了。从经济含义看更加直观，如果我们研究的政策足够独特，我们需要论述政策对每个人都有影响，也就是假设中的单调性。在使用工具变量时，也需要介绍工具变量和解释变量之间的社会关系。所以为何经济学计量区别于数学？这些假设就是对社会现象的描述总结，就是其社科属性的鲜明体现。</p>
<p>最近学习高级宏观也有所体悟。高宏的方法非常单调，变分法加拉格朗日基本解决了所有经典模型的最优化。难点在于每个高宏模型飞来飞去的假设条件和阴间变形。无论是公式变形还是突然施加的假设，都是提炼经济现象的一个特征，然后加以数学化，这才是最大的难点。例如知识生产函数（知识作为全要素）、科夫道格拉斯生产函数（规模报酬）、家庭约束（消费贴现小于财富贴现）、家庭效用函数（风险规避）。</p>
<p>我开始认为——以怎样的框架挖掘均衡；通过经济现象构建具有特性的函数；总结出最优化约束条件才是经济学区别数理复合人才的“经济思想与直觉”。</p>
<p>顺便插入下<a href="https://zhuanlan.zhihu.com/p/613416303" target="_blank" rel="noopener noreffer">高宏笔记</a>
。</p>
<h1 id="总结" class="headerLink">
    <a href="#%e6%80%bb%e7%bb%93" class="header-mark"></a>总结</h1><p>进一步举例子说明，DID估计是ATT；RDD估计是LATE ；聚束分析是LATE。</p>
<p>ATT和LATE是我们所求的，是我们渴望平行世界那样完善的对照试验，但我们有的只是ATE和ITT。</p>
<p>当D满足RCT时，ATE=ATT。</p>
<p>当D不满足RCT，但Z满足时，同时基于单调性和限制约束造出工具变量(IV）或者RDD，此时ITT=LATE。</p>
<p>当D不满足RCT，Z也找不到时，就采用其他方法估计反事实情况，例如群聚分析(通过残差分析变形直接估计反事实的分布和当前集聚现象形成对比)、合成控制&hellip;&hellip;</p>
<blockquote>
<p>教材一般也会引入匹配论来实现这些估计假设。</p>
</blockquote>
<p>综上，计量模型就是基于这样的潜在结果框架分析因果关系，宣扬自己研究的是因果科学。</p>
<p>如此一看，是否颇有&quot;无中生有&quot;,&ldquo;由果索因&quot;之妙也？</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>刘若鸿,许晏君.工业用地价格与企业产能利用率[J].世界经济,2023,46(11):103-127.DOI:10.19985/j.cnki.cassjwe.2023.11.004. ↩ ↩&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>Chen Z, Liu Z, Suárez Serrato J C, et al. Notching R&amp;D investment with corporate income tax cuts in China[J]. American Economic Review, 2021, 111(7): 2065-2100.&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>Pearl J, Mackenzie D. The book of why: the new science of cause and effect[M]. Basic books, 2018.&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a>&#160;<a href="#fnref1:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p>乔舒亚·安格里斯特,约恩-斯特芬·皮施克.基本无害的计量经济学[M].格致出版社,2012.&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5">
<p>Angrist J D, Chen S H, Song J. Long-term consequences of Vietnam-era conscription: New estimates using social security data[J]. American Economic Review, 2011, 101(3): 334-338.&#160;<a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2024-02-28</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://blog.huaxiangshan.com/zh-cn/posts/effect/" data-title="因果效应" data-hashtags="文献阅读,因果效应"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://blog.huaxiangshan.com/zh-cn/posts/effect/" data-hashtag="文献阅读"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Hacker News" data-sharer="hackernews" data-url="https://blog.huaxiangshan.com/zh-cn/posts/effect/" data-title="因果效应"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="https://blog.huaxiangshan.com/zh-cn/posts/effect/" data-title="因果效应"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://blog.huaxiangshan.com/zh-cn/posts/effect/" data-title="因果效应" data-image="/img/1a (1).jpg"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/zh-cn/tags/%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB/">文献阅读</a>,&nbsp;<a href="/zh-cn/tags/%E5%9B%A0%E6%9E%9C%E6%95%88%E5%BA%94/">因果效应</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/zh-cn/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/zh-cn/posts/sss/" class="prev" rel="prev" title="存档：sss级重生猎人第84章"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>存档：sss级重生猎人第84章</a>
            <a href="/zh-cn/posts/h/" class="next" rel="next" title="《河边的错误》是什么">《河边的错误》是什么<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="giscus"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://giscus.app/">giscus</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container">
<div class="footer-line">
	<span id="run-time"></span>
</div><div class="footer-line">
                    由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreferrer" title="Hugo 0.122.0">Hugo</a> 强力驱动&nbsp;|&nbsp;主题 - <a href="https://github.com/HEIGE-PCloud/DoIt" target="_blank" rel="noopener noreferrer" title="DoIt 0.2.10"><i class="far fa-edit fa-fw"></i> DoIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/hzp2333/hzp2333.github.io" target="_blank" rel="noopener noreferrer">滑翔闪</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
            <div class="footer-line">

<style>
    .footerImg {
        height: 20px;  
    }
</style>
<div class="footer-line custom">
<a href="https://icp.gov.moe/?keyword=20244204" target="_blank">萌ICP备20244204号</a>
<a style="text-decoration:none;color:#55bb8a;" href="https://travel.moe/go.html" title="异次元之旅-跃迁-我们一起去萌站成员的星球旅行吧！" target="_blank"><img src="https://travel.moe/images/icon/icon64green.png" style="width:24px;height:24px">异次元之旅</a>
</div>


<style>
    .footerImg {
        height: 20px;  
    }
</style>
<div class="footer-line custom">
    <a href="https://www.travellings.cn/go.html" target="_blank"><img src="https://www.travellings.cn/assets/logo.gif" class="footerImg" alt=""  title="开往-友链接力 v1.5"></a>
    <a href="https://www.foreverblog.cn/" target="_blank"><img src="https://img.foreverblog.cn/logo_en_default.png" class="footerImg" alt="" > </a>
    <a href="https://www.foreverblog.cn/go.html" target="_blank"><img src="https://img.foreverblog.cn/wormhole_2.gif" class="footerImg" alt="" title="穿梭虫洞-随机访问十年之约友链博客"></a>
</div></div>
            <div class="footer-line">
            </div>
        </div></footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.css"><link rel="stylesheet" href="/lib/aplayer/APlayer.min.css"><link rel="stylesheet" href="/lib/aplayer/dark.min.css"><script type="text/javascript" src="/js/giscus.min.js" defer></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/typeit/index.umd.js"></script><script type="text/javascript" src="/lib/aplayer/APlayer.min.js"></script><script type="text/javascript" src="/lib/meting/Meting.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{"giscus":{"dataCategory":"Announcements","dataCategoryId":"DIC_kwDOLbBjxM4Cdr0n","dataEmitMetadata":"0","dataInputPosition":"bottom","dataLang":"en","dataMapping":"pathname","dataReactionsEnabled":"1","dataRepo":"hzp2333/Giscus","dataRepoId":"R_kgDOLbBjxA","dataStrict":"0"}},"data":{"id-1":"滑翔闪'S BLOG","id-2":"滑翔闪'S BLOG"},"lightgallery":true,"search":{"highlightTag":"em","lunrIndexURL":"/zh-cn/index.json","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"lunr"},"typeit":{"cursorChar":null,"cursorSpeed":null,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":null,"speed":null}};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery@2.1.3/dist/jquery.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script><script type="text/javascript" src="/js/custom.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-CYZVM6VVZ8', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-CYZVM6VVZ8" async></script></body>
</html>
