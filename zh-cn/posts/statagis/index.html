<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Stata 绘制 Gis 着色图 - 滑翔闪&#39;S BLOG</title><meta name="Description" content="This is my cool site"><meta property="og:title" content="Stata 绘制 Gis 着色图" />
<meta property="og:description" content="使用 Stata 绘制 GIS 着色图，包括九段线、省县市的模板" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.huaxiangshan.com/zh-cn/posts/statagis/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-22T19:39:56+08:00" />
<meta property="article:modified_time" content="2024-03-22T19:39:56+08:00" /><meta property="og:site_name" content="My cool site" />

<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Stata 绘制 Gis 着色图"/>
<meta name="twitter:description" content="使用 Stata 绘制 GIS 着色图，包括九段线、省县市的模板"/>
<meta name="application-name" content="My cool site">
<meta name="apple-mobile-web-app-title" content="My cool site"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://blog.huaxiangshan.com/zh-cn/posts/statagis/" /><link rel="prev" href="https://blog.huaxiangshan.com/zh-cn/posts/toc/" /><link rel="next" href="https://blog.huaxiangshan.com/zh-cn/posts/fs/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Stata 绘制 Gis 着色图",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/blog.huaxiangshan.com\/zh-cn\/posts\/statagis\/"
        },"genre": "posts","keywords": "Stata, Gis","wordcount":  8264 ,
        "url": "https:\/\/blog.huaxiangshan.com\/zh-cn\/posts\/statagis\/","datePublished": "2024-03-22T19:39:56+08:00","dateModified": "2024-03-22T19:39:56+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "滑翔闪"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper">












<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sakana 小组件集成</title>
  <style>
     
    #sakana-widget-container {
      position: fixed;
      bottom: 10px;
      left: 10px;
      width: 268px;
      height: 268px;
    }
    #sakana-widget {
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <div id="sakana-widget-container">
    <div id="sakana-widget"></div>
  </div>

  <script>
    function initSakanaWidget() {
      new SakanaWidget({
        size: 300,
        autoFit: true,
        character: 'chisato',
        controls: true,
        rod: true,
        draggable: true,
        stroke: { color: '#b4b4b4', width: 10 },
        threshold: 0.1,
        rotate: 0,
        title: false
      }).mount('#sakana-widget');

      
      checkScreenWidth();
      window.addEventListener('resize', checkScreenWidth);
    }

    function checkScreenWidth() {
      var screenWidth = window.innerWidth;
      var container = document.getElementById('sakana-widget-container');
      if (screenWidth <= 960) {
        container.style.display = 'none';
      } else {
        container.style.display = 'block';
      }
    }
  </script>

  
  <script 
    async
    onload="initSakanaWidget()"
    src="https://cdn.jsdelivr.net/npm/sakana-widget@2.2.2/lib/sakana.min.js">
  </script>
</body>
</html>




<script type="text/javascript" color="0,174,255" opacity='0.7' zIndex="-2" count="200" src="https://www.liuzehe.top/upload/bkjs/bj.js"></script><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/zh-cn/" title="滑翔闪&#39;S BLOG"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/%E7%9F%9B%E7%9B%BE.png"
        data-srcset="/images/%E7%9F%9B%E7%9B%BE.png, /images/%E7%9F%9B%E7%9B%BE.png 1.5x, /images/%E7%9F%9B%E7%9B%BE.png 2x"
        data-sizes="auto"
        alt="/images/%E7%9F%9B%E7%9B%BE.png"
        title="/images/%E7%9F%9B%E7%9B%BE.png" /><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/zh-cn/posts/" title="书中自有黄金屋"><i class='fa fa-solid fa-book'></i> 文章 </a><a class="menu-item" href="/zh-cn/tags/" title="定义文章，不定义世界"><i class='fa fa-tag'></i> 标签 </a><a class="menu-item" href="/zh-cn/categories/" title="分类是种视角"><i class='fa fa-archive'></i> 分类 </a><a class="menu-item" href="/zh-cn/friends/" title="有朋自远方来"><i class='fa fa-user-group'></i> 友链  </a><a class="menu-item" href="/zh-cn/about/" title="人穷其一生寻找自己"> <i class='fa fa-address-card'></i> 关于 </a><a class="menu-item" href="https://www.travellings.cn/go.html" title="漫长的列车驶向未来" rel="noopener noreffer" target="_blank"><i class='fa fa-train-subway'></i> 开往  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="吾将上下而求索" id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="选择语言">
                    <i class="fa fa-globe" aria-hidden="true"></i>                      
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/zh-cn/posts/statagis/" selected>简体中文</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/zh-cn/" title="滑翔闪&#39;S BLOG"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/%E7%9F%9B%E7%9B%BE.png"
        data-srcset="/images/%E7%9F%9B%E7%9B%BE.png, /images/%E7%9F%9B%E7%9B%BE.png 1.5x, /images/%E7%9F%9B%E7%9B%BE.png 2x"
        data-sizes="auto"
        alt="/images/%E7%9F%9B%E7%9B%BE.png"
        title="/images/%E7%9F%9B%E7%9B%BE.png" /><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="吾将上下而求索" id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/zh-cn/posts/" title="书中自有黄金屋"><i class='fa fa-solid fa-book'></i>文章</a><a class="menu-item" href="/zh-cn/tags/" title="定义文章，不定义世界"><i class='fa fa-tag'></i>标签</a><a class="menu-item" href="/zh-cn/categories/" title="分类是种视角"><i class='fa fa-archive'></i>分类</a><a class="menu-item" href="/zh-cn/friends/" title="有朋自远方来"><i class='fa fa-user-group'></i>友链 </a><a class="menu-item" href="/zh-cn/about/" title="人穷其一生寻找自己"> <i class='fa fa-address-card'></i>关于</a><a class="menu-item" href="https://www.travellings.cn/go.html" title="漫长的列车驶向未来" rel="noopener noreffer" target="_blank"><i class='fa fa-train-subway'></i>开往 </a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="选择语言">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/zh-cn/posts/statagis/" selected>简体中文</option></select>
                </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Stata 绘制 Gis 着色图</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://github.com/hzp2333/hzp2333.github.io" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>滑翔闪</a></span>&nbsp;<span class="post-category">收录于 <a href="/zh-cn/categories/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>软件工具</a>&nbsp;<a href="/zh-cn/categories/%E7%BB%8F%E6%B5%8E%E5%AD%A6%E4%B9%A0/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>经济学习</a></span></div>

            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2024-03-22">2024-03-22</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 8264 字
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 17 分钟&nbsp;
    

    
        

        
        
            <span id="busuanzi_container_value_page_pv"><i class="far fa-eye fa-fw"></i>
                
                <span id="busuanzi_value_page_pv"></span>&nbsp;次阅读</span>
        
    


</div>

        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132359071.webp"
        data-srcset="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132359071.webp, /img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132359071.webp 1.5x, /img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132359071.webp 2x"
        data-sizes="auto"
        alt="/img/Stata绘制Gis着色图.zh-cn-20240523132359071.webp"
        title="/img/Stata绘制Gis着色图.zh-cn-20240523132359071.webp" /></div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#获取地图文件">获取地图文件</a></li>
    <li><a href="#statagis-初步操作">StataGis 初步操作</a>
      <ul>
        <li><a href="#下载相关命令">下载相关命令</a></li>
        <li><a href="#转译和编译乱码">转译和编译乱码</a></li>
        <li><a href="#匹配数据和标签文件">匹配数据和标签文件</a></li>
        <li><a href="#绘图命令">绘图命令</a></li>
        <li><a href="#参数解释">参数解释</a></li>
      </ul>
    </li>
    <li><a href="#处理流程图">处理流程图</a></li>
    <li><a href="#国内省级">国内省级</a>
      <ul>
        <li><a href="#正式绘图">正式绘图</a></li>
        <li><a href="#其他例子">其他例子</a></li>
        <li><a href="#调节指南针和图例">调节指南针和图例</a></li>
      </ul>
    </li>
    <li><a href="#国内市级">国内市级</a></li>
    <li><a href="#国内县级">国内县级</a></li>
    <li><a href="#geoplot-命令">Geoplot 命令</a>
      <ul>
        <li><a href="#下载相关命令-1">下载相关命令</a></li>
        <li><a href="#载入数据">载入数据</a></li>
        <li><a href="#画图">画图</a>
          <ul>
            <li><a href="#基本命令">基本命令</a></li>
            <li><a href="#气泡图">气泡图</a></li>
            <li><a href="#局部放大图">局部放大图</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#地图使用规范">地图使用规范</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>今天这里记录的是用 Stata 画 Gis 着色图的过程。</p>
<p>本文列举所有数据可在<a href="https://github.com/hzp2333/STATAGIS" target="_blank" rel="noopener noreffer ">仓库</a>下载。</p>
<h2 id="获取地图文件">获取地图文件</h2>
<p><code>ESRI Shapefile</code> 文件是由<a href="https://www.esri.com/en-us/home" target="_blank" rel="noopener noreffer ">美国环境系统研究所</a>开发的空间地理数据。里面同时储存空间位置和特征数据。其基本文件主要为：</p>
<ul>
<li>
<p><strong>主文件 (. Shp)：</strong> 存储几何要素的的空间信息，也就是 XY 坐标。Gis 图片的地图轮廓信息就是这个文件储存的。</p>
</li>
<li>
<p><strong>表文件 (. Dbf)：</strong> 存储地理数据的属性信息的 dBase 表。</p>
</li>
<li>
<p><strong>索引文件 (. Shx)：</strong> 存储有关 .shp 存储的索引信息。它记录了在 .shp 中，空间数据是如何存储的，XY 坐标的输入点在哪里，有多少 XY 坐标对等信息。</p>
</li>
</ul>
<p>这里介绍写我找到的一些数据源：</p>
<ul>
<li>
<p><a href="http://gaohr.win/site/blogs/2017/2017-04-18-GIS-basic-data-of-China.html" target="_blank" rel="noopener noreffer ">大饼的博客</a></p>
</li>
<li>
<p><a href="https://www.webmap.cn/main.do?method=index" target="_blank" rel="noopener noreffer ">全国地理信息资源目录服务系统</a></p>
</li>
<li>
<p><a href="https://gadm.org/data.html" target="_blank" rel="noopener noreffer ">GADM data</a>：国际地图很全。</p>
</li>
<li>
<p><a href="https://github.com/GaryBikini/ChinaAdminDivisonSHP" target="_blank" rel="noopener noreffer ">github随手找到的中国地图数据</a></p>
</li>
<li>
<p><a href="https://github.com/Wsf921109/stata-prov-map?tab=readme-ov-file" target="_blank" rel="noopener noreffer ">Rstata资料</a>：中国地图省级分区。国内买课世界一流，个人觉得 stata 专题做得最好的是“连享会&quot;和&quot;Rstata&quot;。即便我是坚定的<del>白嫖</del>开源主义，也经常看他们的科普文章学习 stata。此处是有好心人上传了 Rstata 相关的数据库。</p>
</li>
<li>
<p><a href="https://www.resdc.cn/Default.aspx" target="_blank" rel="noopener noreffer ">中科院地资所</a>：或许是国内的半官方？</p>
<p>
<figure class="center-figure"><a class="lightgallery" href="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132141972.webp" title="中科院地资所" data-thumbnail="/img/Stata绘制Gis着色图.zh-cn-20240523132141972.webp" data-sub-html="<h2> </h2><p>中科院地资所</p>">
        <img
            class="lazyload center-image"
            src="/svg/loading.min.svg"
            data-src="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132141972.webp"
            data-srcset="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132141972.webp, /img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132141972.webp 1.5x, /img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132141972.webp 2x"
            data-sizes="auto"
            alt="/img/Stata绘制Gis着色图.zh-cn-20240523132141972.webp" />
    </a><figcaption class="image-caption">中科院地资所</figcaption>
    </figure></p>
</li>
</ul>
<p>如果还找不到自己想要的，可以使用阿里云地图来生成地图文件。</p>
<p>进入<a href="http://datav.aliyun.com/portal/school/atlas/area_selector" target="_blank" rel="noopener noreffer ">阿里云地图</a>，点击文件下载（推荐其他下载，下载后得到 <code>.json</code> 文件）。</p>
<p>下载好后进入<a href="https://mapshaper.org/" target="_blank" rel="noopener noreffer ">转化器</a>转化。点击 <code>Select</code>，上传 <code>.json</code> 文件，然后点击 <code>export</code> 导出转化后的文件。</p>
<blockquote>
<p>似乎是因为数据编码或者加密，有时候转阿里云地图化的文件无法被 stata 读取。</p>
<p>此时使用 <code>spshape2dta</code> 转化</p>
</blockquote>
<h2 id="statagis-初步操作">StataGis 初步操作</h2>
<h3 id="下载相关命令">下载相关命令</h3>
<p>包含 <code>主文件 (.shp)</code> 和 <code>表文件 (.dbf)</code> 即可。</p>
<p>提前在 stata 下载相关命令。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">ssc</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">shp2dta</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w">   </span><span class="o">//</span><span class="err">文件转化命令</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ssc</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">mif2dta</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w">  </span><span class="o">//</span><span class="err">文件转化命令</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ssc</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">spmap</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w">  </span><span class="o">//</span><span class="n">GIS画图命令</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="转译和编译乱码">转译和编译乱码</h3>
<p>使用 B 站一位用户用 GIS 画的文件：<a href="https://pan.baidu.com/s/1lybhxKO3EL5JKATULS-0CA?pwd=zkks" target="_blank" rel="noopener noreffer ">2019中国地图-审图号GS(2019)1822号</a></p>
<p>这里个人使用的举例数据是：<a href="https://idf.pku.edu.cn/yjcg/zsbg/513800.htm" target="_blank" rel="noopener noreffer ">北大数字普惠金融指数2011_2020</a></p>
<p>这里要转译的有两个文件，中国地图文件 <code>市</code> 和九段线文件 <code>九段线</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">clear</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">cd</span><span class="w"> </span><span class="n">F</span><span class="p">:</span><span class="err">\桌面\</span><span class="n">GIS_sum</span><span class="err">\</span><span class="mi">2019</span><span class="err">中国地图审图号\例子</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="err">设置工作环境文件夹，因为</span><span class="n">gis一些命令参数使用相对路径更好用些</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">import</span><span class="w"> </span><span class="n">excel</span><span class="w"> </span><span class="s2">&#34;F:\桌面\GIS_sum\2019中国地图审图号\例子\北大数字普惠金融指数2011_2020.xlsx&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">sheet</span><span class="p">(</span><span class="s2">&#34;Sheet1&#34;</span><span class="p">)</span><span class="w"> </span><span class="n">firstrow</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">keep</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2020</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">rename</span><span class="w"> </span><span class="n">pref_name_year18</span><span class="w"> </span><span class="n">ct_name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">save</span><span class="w"> </span><span class="n">d2020data</span><span class="w"> </span><span class="p">,</span><span class="k">replace</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="err">载入数据</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">spshape2dta</span><span class="w"> </span><span class="err">市</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">spshape2dta</span><span class="w"> </span><span class="err">九段线</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="err">这里因为无法用</span><span class="n">shp2dta转化所以使用spshape2dta</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">clear</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">cd</span><span class="w"> </span><span class="n">F</span><span class="p">:</span><span class="err">\桌面\</span><span class="n">GIS_sum</span><span class="err">\</span><span class="mi">2019</span><span class="err">中国地图审图号\例子</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">unicode</span><span class="w"> </span><span class="k">encoding</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="n">gb18030</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">unicode</span><span class="w"> </span><span class="k">analyze</span><span class="w"> </span><span class="err">市</span><span class="p">.</span><span class="n">dta</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">unicode</span><span class="w"> </span><span class="k">translate</span><span class="w"> </span><span class="err">市</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="n">invalid</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="err">部分中文乱码重新编译</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="err">一次性命令，若要重新使用需要删掉目录生成的编码文件</span><span class="n">bak</span><span class="p">.</span><span class="n">stunicode</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>若文件无法被转化，例如阿里云的地图，似乎 gis 做的地图也无法被 <code>shp2dta</code> 转化。这里就是使用的 <code>spshape2dta</code> 转化。</p>
<blockquote>
<p>两个命令除了这一点外<a href="https://www.cda.cn/discuss/post/details/61cd24316276b453ec6f9bc2" target="_blank" rel="noopener noreffer ">区别不大</a>。<code>spshape2dta</code> 命令缺点是不能自定义名字，后面直接跟文件名即可，会自动生成两个需要的文件。标签文件为 <code>.dta</code>, 轮廓文件为 <code>_shp.dta</code></p>
</blockquote>
<h3 id="匹配数据和标签文件">匹配数据和标签文件</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">use</span><span class="w"> </span><span class="err">市</span><span class="p">.</span><span class="n">dta</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">rename</span><span class="w"> </span><span class="n">__</span><span class="w"> </span><span class="n">ct_name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">save</span><span class="w"> </span><span class="err">市</span><span class="p">.</span><span class="n">dta</span><span class="w"> </span><span class="p">,</span><span class="k">replace</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">use</span><span class="w"> </span><span class="n">d2020data</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">merge</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="w"> </span><span class="n">ct_name</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="err">市</span><span class="p">.</span><span class="n">dta</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">drop</span><span class="w"> </span><span class="n">_merge</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gen</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="o">=</span><span class="n">_ID</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">save</span><span class="w"> </span><span class="n">city_data2020</span><span class="p">,</span><span class="k">replace</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="绘图命令">绘图命令</h3>
<p>开始绘图，基本绘图命令如下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">grmap</span><span class="w"> </span><span class="n">digitization_level</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="err">市</span><span class="n">_shp</span><span class="p">.</span><span class="n">dta</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">id</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="w"> </span><span class="n">osize</span><span class="p">(</span><span class="n">vvthin</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="n">ocolor</span><span class="p">(</span><span class="n">white</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">clmethod</span><span class="p">(</span><span class="n">custom</span><span class="p">)</span><span class="w"> </span><span class="n">clbreaks</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">190</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="mi">280</span><span class="w"> </span><span class="mi">300</span><span class="w"> </span><span class="mi">350</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">fcolor</span><span class="p">(</span><span class="n">gray</span><span class="w"> </span><span class="s2">&#34;224 242 241&#34;</span><span class="w"> </span><span class="s2">&#34;178 223 219&#34;</span><span class="w"> </span><span class="s2">&#34;128 203 196&#34;</span><span class="w"> </span><span class="s2">&#34;77 182 172&#34;</span><span class="w"> </span><span class="s2">&#34;38 166 154&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">leg</span><span class="p">(</span><span class="k">order</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="s2">&#34;无数据&#34;</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="s2">&#34;0~190&#34;</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="s2">&#34;190~200&#34;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="s2">&#34;200~280&#34;</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="s2">&#34;280~300&#34;</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="s2">&#34;300~350&#34;</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">graphr</span><span class="p">(</span><span class="n">margin</span><span class="p">(</span><span class="n">medium</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">line</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="err">九段线</span><span class="n">_shp</span><span class="p">.</span><span class="n">dta</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">ti</span><span class="p">(</span><span class="s2">&#34;2020 年数字普惠金融指数&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">subti</span><span class="p">(</span><span class="s2">&#34;二级标题&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">caption</span><span class="p">(</span><span class="s2">&#34;数据来源：北大数字普惠金融指数&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>
<figure class="center-figure"><a class="lightgallery" href="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132211710.webp" title="就画图命令而言，spmap和grmap似乎没有区别" data-thumbnail="/img/Stata绘制Gis着色图.zh-cn-20240523132211710.webp" data-sub-html="<h2> </h2><p>就画图命令而言，spmap和grmap似乎没有区别</p>">
        <img
            class="lazyload center-image"
            src="/svg/loading.min.svg"
            data-src="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132211710.webp"
            data-srcset="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132211710.webp, /img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132211710.webp 1.5x, /img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132211710.webp 2x"
            data-sizes="auto"
            alt="/img/Stata绘制Gis着色图.zh-cn-20240523132211710.webp" />
    </a><figcaption class="image-caption">就画图命令而言，spmap和grmap似乎没有区别</figcaption>
    </figure></p>
<h3 id="参数解释">参数解释</h3>
<p>以下参数解释由 GPT 3.5 给出，个人进行简单补充。</p>
<ul>
<li>
<p><code>grmap type</code>：指定图形类型为地图。</p>
</li>
<li>
<p><code>using chinaprov40_coord.dta</code>：指定地图数据文件，包含省级行政区划的坐标信息。</p>
</li>
<li>
<p><code>id(ID)</code>：指定地图数据中的唯一标识符变量。通过标识对应地图坐标和标签和数据。</p>
</li>
<li>
<p><code>osize(vvthin ...)</code> 和 <code>ocolor(white ...)</code>：设置地图边界线的粗细和颜色。</p>
</li>
<li>
<p><code>vvthin</code> 是 Stata 中一种预定义的线条样式，它表示非常细的线条。在绘制地图时，可以使用不同的线条粗细来区分不同的地理要素或边界。</p>
<blockquote>
<p>从细到粗排列为：vvthin、vthin、thin、medium、thick、vthick、vvthick。</p>
</blockquote>
</li>
<li>
<p><code>clmethod(custom)</code> 和 <code>clbreaks(0 1 2 3 4 5)</code>：自定义分类方法和分类间隔。这里对应的是省级分类，直辖市，省，特别行政区&hellip;</p>
</li>
<li>
<p><code>fcolor(...)</code>：指定不同分类的填充颜色。</p>
<blockquote>
<p>例子中采用的是三元色定义表示，可以用 PPT 的颜色自定义查看颜色标识。</p>
</blockquote>
<p>
<figure class="center-figure"><a class="lightgallery" href="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132227149.webp" title="三元色定义" data-thumbnail="/img/Stata绘制Gis着色图.zh-cn-20240523132227149.webp" data-sub-html="<h2> </h2><p>三元色定义</p>">
        <img
            class="lazyload center-image"
            src="/svg/loading.min.svg"
            data-src="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132227149.webp"
            data-srcset="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132227149.webp, /img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132227149.webp 1.5x, /img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132227149.webp 2x"
            data-sizes="auto"
            alt="/img/Stata绘制Gis着色图.zh-cn-20240523132227149.webp" />
    </a><figcaption class="image-caption">三元色定义</figcaption>
    </figure></p>
</li>
<li>
<p><code>leg(...)</code>：设置图例的顺序和标签。</p>
</li>
<li>
<p><code>graphr(margin(medium))</code>：设置图形的边距。</p>
</li>
<li>
<p><code>line(data(chinaprov40_line_coord.dta) by(group) ...)</code>：绘制地图边界线，指定边界线数据文件和颜色等属性。这里用的是九段线文件。</p>
</li>
<li>
<p><code>polygon(data(polygon) fcolor(black) ...)</code>：绘制地图多边形，指定填充颜色和线条粗细等属性。这里是图例和指南针。</p>
</li>
<li>
<p><code>label(data(chinaprov40_label) ...)</code>：标注地图上的标签，指定标签数据文件和标签文本等属性。<code>label(ename)</code> 是英文，<code>label(cnname)</code> 是中文。</p>
</li>
<li>
<p><code>ti(&quot;一级标题: 2019 年中国省级行政区划&quot;)</code>：设置主标题。</p>
</li>
<li>
<p><code>subti(&quot;二级标题&quot;)</code>：设置副标题。</p>
</li>
<li>
<p><code>caption(&quot;使用 Stata 绘制中国省级地图&quot;, size(*0.8))</code>：设置图形的说明。</p>
</li>
</ul>
<h2 id="处理流程图">处理流程图</h2>
<blockquote>
<p>地图线条数据（非必要）：例如山川、河流、山脉、九段线、秦岭淮河、胡焕庸线的线条。</p>
</blockquote>
<div class="mermaid" id="id-1"></div>
<p>看起来很复杂？这里给出简单的步骤概括：</p>
<ul>
<li>获得我们想要描述的数据，每个省数值是多少。</li>
<li>将描述数据和 <code>_db.dta</code>（索引文件，<code>.dbf</code> 文件转化而来）匹配到一起。</li>
<li>打开匹配完成的数据，额外载入地图轮廓数据（<code>_coord.dta</code>）（<code>.shp </code> 文件转化而来）。</li>
<li>选择：可以加入 label 文件（是否显示每个省份名称）</li>
</ul>
<h2 id="国内省级">国内省级</h2>
<blockquote>
<p>来自 Rstata。可以从 <a href="https://github.com/Wsf921109/stata-prov-map" target="_blank" rel="noopener noreffer ">github仓库</a>下载学习材料——GIS 地图省级面板和相关数据。</p>
</blockquote>
<div class="bilibili"><iframe src="//player.bilibili.com/player.html?bvid=BV12L411J7Vt&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"></iframe></div>

<div class="details admonition tip">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw" aria-hidden="true"></i>文件简介<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>地图轮廓数据：</p>
<p><code>chinaprov40_db.dta</code></p>
<p><code>chinaprov40_coord.dta</code></p>
<p>线条数据：例如九段线，胡焕庸线等</p>
<p><code>chinaprov40_line_db.dta</code></p>
<p><code>chinaprov40_line_coord.dta</code></p>
<p>标签位置数据</p>
<p><code>chinaprov40_label.dta</code></p>
<p>绘画指北针和比例尺</p>
<p><code>polygon.dta</code></p>
</div>
        </div>
    </div>
<h3 id="正式绘图">正式绘图</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">cd</span><span class="w"> </span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="err">系列课程</span><span class="o">/</span><span class="err">使用</span><span class="n">Stata绘制中国省级地图</span><span class="err">（版本</span><span class="mi">4</span><span class="err">）</span><span class="o">/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">*</span><span class="w"> </span><span class="err">离散变量的绘制</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">use</span><span class="w"> </span><span class="n">chinaprov40_db</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="n">clear</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">encode</span><span class="w"> </span><span class="err">类型</span><span class="p">,</span><span class="w"> </span><span class="n">gen</span><span class="p">(</span><span class="k">type</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">codebook</span><span class="w"> </span><span class="k">type</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">*</span><span class="err">如果</span><span class="n">gramp命令没激活</span><span class="err">，输入</span><span class="n">grmap</span><span class="p">,</span><span class="w"> </span><span class="n">activate命令即可</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">grmap</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">chinaprov40_coord</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">id</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="w"> </span><span class="n">osize</span><span class="p">(</span><span class="n">vvthin</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="n">ocolor</span><span class="p">(</span><span class="n">white</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">clmethod</span><span class="p">(</span><span class="n">custom</span><span class="p">)</span><span class="w"> </span><span class="n">clbreaks</span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">fcolor</span><span class="p">(</span><span class="s2">&#34;254 212 57&#34;</span><span class="w"> </span><span class="s2">&#34;253 116 70&#34;</span><span class="w"> </span><span class="s2">&#34;138 145 151&#34;</span><span class="w"> </span><span class="s2">&#34;213 228 162&#34;</span><span class="w"> </span><span class="s2">&#34;210 175 129&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">leg</span><span class="p">(</span><span class="k">order</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="s2">&#34;不统计&#34;</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="s2">&#34;特别行政区&#34;</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="s2">&#34;直辖市&#34;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="s2">&#34;省&#34;</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="s2">&#34;自治区&#34;</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="s2">&#34;秦岭-淮河线&#34;</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="s2">&#34;胡焕庸线&#34;</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">graphr</span><span class="p">(</span><span class="n">margin</span><span class="p">(</span><span class="n">medium</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">line</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">chinaprov40_line_coord</span><span class="p">.</span><span class="n">dta</span><span class="p">)</span><span class="w"> </span><span class="k">by</span><span class="p">(</span><span class="k">group</span><span class="p">)</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="n">vvthin</span><span class="w"> </span><span class="o">*</span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">pattern</span><span class="p">(</span><span class="n">solid</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">color</span><span class="p">(</span><span class="n">white</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">省界颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">国界线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="s2">&#34;0 85 170&#34;</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">海岸线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="s2">&#34;24 188 156&#34;</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">秦岭淮河线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">小地图框格颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">比例尺和指北针颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="s2">&#34;227 26 28&#34;</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">胡焕庸线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">polygon</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span><span class="w"> </span><span class="n">fcolor</span><span class="p">(</span><span class="n">black</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">osize</span><span class="p">(</span><span class="n">vvthin</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">label</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">chinaprov40_label</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="w"> </span><span class="n">label</span><span class="p">(</span><span class="n">cname</span><span class="p">)</span><span class="w"> </span><span class="k">length</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">ti</span><span class="p">(</span><span class="s2">&#34;一级标题: 2019 年中国省级行政区划&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">subti</span><span class="p">(</span><span class="s2">&#34;二级标题&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">caption</span><span class="p">(</span><span class="s2">&#34;使用 Stata 绘制中国省级地图&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gr</span><span class="w"> </span><span class="n">export</span><span class="w"> </span><span class="n">pic1</span><span class="p">.</span><span class="n">png</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="n">width</span><span class="p">(</span><span class="mi">1200</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">*</span><span class="w"> </span><span class="err">英文版本</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">grmap</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">chinaprov40_coord</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">id</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="w"> </span><span class="n">osize</span><span class="p">(</span><span class="n">vvthin</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="n">ocolor</span><span class="p">(</span><span class="n">white</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">clmethod</span><span class="p">(</span><span class="n">custom</span><span class="p">)</span><span class="w"> </span><span class="n">clbreaks</span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">fcolor</span><span class="p">(</span><span class="s2">&#34;254 212 57&#34;</span><span class="w"> </span><span class="s2">&#34;253 116 70&#34;</span><span class="w"> </span><span class="s2">&#34;138 145 151&#34;</span><span class="w"> </span><span class="s2">&#34;213 228 162&#34;</span><span class="w"> </span><span class="s2">&#34;210 175 129&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">leg</span><span class="p">(</span><span class="k">order</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="s2">&#34;Not within the scope of statistics&#34;</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="s2">&#34;Special administrative region&#34;</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="s2">&#34;Municipality directly under&#34;</span><span class="w"> </span><span class="s2">&#34;the Central Government&#34;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="s2">&#34;Province&#34;</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="s2">&#34;Autonomous Region&#34;</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="s2">&#34;Qinling Huaihe River Line&#34;</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="s2">&#34;Hu Huanyong line&#34;</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">graphr</span><span class="p">(</span><span class="n">margin</span><span class="p">(</span><span class="n">medium</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">line</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">chinaprov40_line_coord</span><span class="p">.</span><span class="n">dta</span><span class="p">)</span><span class="w"> </span><span class="k">by</span><span class="p">(</span><span class="k">group</span><span class="p">)</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="n">vvthin</span><span class="w"> </span><span class="o">*</span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">pattern</span><span class="p">(</span><span class="n">solid</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">color</span><span class="p">(</span><span class="n">white</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">省界颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">国界线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="s2">&#34;0 85 170&#34;</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">海岸线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="s2">&#34;24 188 156&#34;</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">秦岭淮河线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">小地图框格颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">比例尺和指北针颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="s2">&#34;227 26 28&#34;</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">胡焕庸线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">polygon</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span><span class="w"> </span><span class="n">fcolor</span><span class="p">(</span><span class="n">black</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">osize</span><span class="p">(</span><span class="n">vvthin</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">label</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">chinaprov40_label</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="w"> </span><span class="n">label</span><span class="p">(</span><span class="n">ename</span><span class="p">)</span><span class="w"> </span><span class="k">length</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">6</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">ti</span><span class="p">(</span><span class="s2">&#34;title1: China’s provincial administrative divisions in 2019&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">subti</span><span class="p">(</span><span class="s2">&#34;title2&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">caption</span><span class="p">(</span><span class="s2">&#34;Use Stata to draw provincial maps of China&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gr</span><span class="w"> </span><span class="n">export</span><span class="w"> </span><span class="n">pic2</span><span class="p">.</span><span class="n">png</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="n">width</span><span class="p">(</span><span class="mi">1200</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>
<figure class="center-figure"><a class="lightgallery" href="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132257418.webp" title="使用 Stata 绘制 2019 年中国省级行政区划" data-thumbnail="/img/Stata绘制Gis着色图.zh-cn-20240523132257418.webp" data-sub-html="<h2> </h2><p>使用 Stata 绘制 2019 年中国省级行政区划</p>">
        <img
            class="lazyload center-image"
            src="/svg/loading.min.svg"
            data-src="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132257418.webp"
            data-srcset="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132257418.webp, /img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132257418.webp 1.5x, /img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132257418.webp 2x"
            data-sizes="auto"
            alt="/img/Stata绘制Gis着色图.zh-cn-20240523132257418.webp" />
    </a><figcaption class="image-caption">使用 Stata 绘制 2019 年中国省级行政区划</figcaption>
    </figure></p>
<h3 id="其他例子">其他例子</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">*</span><span class="w"> </span><span class="err">绘图示例：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">*</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="w"> </span><span class="mi">2020</span><span class="w"> </span><span class="err">年中国各省市地区生产总值</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">import</span><span class="w"> </span><span class="n">delimited</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="s2">&#34;2020年中国各省市地区生产总值.csv&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">clear</span><span class="w"> </span><span class="k">encoding</span><span class="p">(</span><span class="n">utf8</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gen</span><span class="w"> </span><span class="n">prov</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">substr</span><span class="p">(</span><span class="err">省份</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">save</span><span class="w"> </span><span class="mi">2020</span><span class="err">年中国各省市地区生产总值</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">use</span><span class="w"> </span><span class="n">chinaprov40_db</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="n">clear</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gen</span><span class="w"> </span><span class="n">prov</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">substr</span><span class="p">(</span><span class="err">省</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">merge</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="w"> </span><span class="n">prov</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="mi">2020</span><span class="err">年中国各省市地区生产总值</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">replace</span><span class="w"> </span><span class="err">地区生产总值</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">missing</span><span class="p">(</span><span class="err">地区生产总值</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">grmap</span><span class="w"> </span><span class="err">地区生产总值</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">chinaprov40_coord</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">id</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="w"> </span><span class="n">osize</span><span class="p">(</span><span class="n">vvthin</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="n">ocolor</span><span class="p">(</span><span class="n">white</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">clmethod</span><span class="p">(</span><span class="n">custom</span><span class="p">)</span><span class="w"> </span><span class="n">clbreaks</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">20000</span><span class="w"> </span><span class="mi">40000</span><span class="w"> </span><span class="mi">60000</span><span class="w"> </span><span class="mi">80000</span><span class="w"> </span><span class="mi">120000</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">fcolor</span><span class="p">(</span><span class="n">gray</span><span class="w"> </span><span class="s2">&#34;224 242 241&#34;</span><span class="w"> </span><span class="s2">&#34;178 223 219&#34;</span><span class="w"> </span><span class="s2">&#34;128 203 196&#34;</span><span class="w"> </span><span class="s2">&#34;77 182 172&#34;</span><span class="w"> </span><span class="s2">&#34;38 166 154&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">leg</span><span class="p">(</span><span class="k">order</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="s2">&#34;无数据&#34;</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="s2">&#34;&lt; 2 万亿元&#34;</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="s2">&#34;2～4 万亿元&#34;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="s2">&#34;4～6 万亿元&#34;</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="s2">&#34;6～8 万亿元&#34;</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="s2">&#34;&gt; 8 万亿元&#34;</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">graphr</span><span class="p">(</span><span class="n">margin</span><span class="p">(</span><span class="n">medium</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">line</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">chinaprov40_line_coord</span><span class="p">.</span><span class="n">dta</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="o">///</span><span class="w"> </span><span class="err">去除秦岭淮河线</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="err">、胡焕庸线</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">select</span><span class="p">(</span><span class="n">keep</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">inlist</span><span class="p">(</span><span class="k">group</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">by</span><span class="p">(</span><span class="k">group</span><span class="p">)</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="n">vvthin</span><span class="w"> </span><span class="o">*</span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">pattern</span><span class="p">(</span><span class="n">solid</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">实线</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">color</span><span class="p">(</span><span class="n">white</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">省界颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">国界线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="s2">&#34;0 85 170&#34;</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">海岸线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">小地图框格颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">比例尺和指北针颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">polygon</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span><span class="w"> </span><span class="n">fcolor</span><span class="p">(</span><span class="n">black</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">osize</span><span class="p">(</span><span class="n">vvthin</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">label</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">chinaprov40_label</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="w"> </span><span class="n">label</span><span class="p">(</span><span class="n">cname</span><span class="p">)</span><span class="w"> </span><span class="k">length</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">ti</span><span class="p">(</span><span class="s2">&#34;2020 年中国各省市地区生产总值&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">subti</span><span class="p">(</span><span class="s2">&#34;二级标题&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">caption</span><span class="p">(</span><span class="s2">&#34;数据来源：各地统计局&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gr</span><span class="w"> </span><span class="n">export</span><span class="w"> </span><span class="n">pic3</span><span class="p">.</span><span class="n">png</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="n">width</span><span class="p">(</span><span class="mi">1200</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">*</span><span class="w"> </span><span class="mi">2013</span><span class="w"> </span><span class="err">年中国工企业分布及距离秦岭淮河的距离</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">*</span><span class="w"> </span><span class="err">转换坐标系</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">*</span><span class="w"> </span><span class="err">转换方式一：</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">czxb</span><span class="p">.</span><span class="n">shinyapps</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">crs</span><span class="o">-</span><span class="n">trans</span><span class="o">/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">*</span><span class="w"> </span><span class="err">注意事项，上传的</span><span class="w"> </span><span class="n">csv</span><span class="w"> </span><span class="err">文件应该包含数值型的</span><span class="w"> </span><span class="n">lon</span><span class="w"> </span><span class="err">和</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="err">变量，观测值上限大概是</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="err">万个，不可多人同时使用。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">use</span><span class="w"> </span><span class="n">gq2013sample</span><span class="p">,</span><span class="w"> </span><span class="n">clear</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">keep</span><span class="w"> </span><span class="err">经度</span><span class="w"> </span><span class="err">纬度</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ren</span><span class="w"> </span><span class="err">经度</span><span class="w"> </span><span class="n">lon</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ren</span><span class="w"> </span><span class="err">纬度</span><span class="w"> </span><span class="n">lat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">export</span><span class="w"> </span><span class="n">delimited</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="s2">&#34;待转换.csv&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">*</span><span class="w"> </span><span class="err">转换方式二：使用附件中的</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="err">脚本转换</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">*</span><span class="w"> </span><span class="err">处理转换后的数据</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">import</span><span class="w"> </span><span class="n">delimited</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="s2">&#34;转换后的数据.csv&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">clear</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gen</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_n</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">save</span><span class="w"> </span><span class="err">转换后的数据</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">use</span><span class="w"> </span><span class="n">gq2013sample</span><span class="p">,</span><span class="w"> </span><span class="n">clear</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gen</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_n</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">merge</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="err">转换后的数据</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">drop</span><span class="w"> </span><span class="n">_m</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">*</span><span class="err">度</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">encode</span><span class="w"> </span><span class="err">北方或南方</span><span class="p">,</span><span class="w"> </span><span class="n">gen</span><span class="p">(</span><span class="n">north</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">save</span><span class="w"> </span><span class="n">pointdata</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">use</span><span class="w"> </span><span class="n">chinaprov40_db</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="n">clear</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">spmap</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">chinaprov40_coord</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">ocolor</span><span class="p">(</span><span class="s2">&#34;black&#34;</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="n">osize</span><span class="p">(</span><span class="n">vvthin</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">line</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">chinaprov40_line_coord</span><span class="p">.</span><span class="n">dta</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="o">///</span><span class="w"> </span><span class="err">胡焕庸线（</span><span class="mi">7</span><span class="err">）</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">select</span><span class="p">(</span><span class="n">keep</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">inlist</span><span class="p">(</span><span class="k">group</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">by</span><span class="p">(</span><span class="k">group</span><span class="p">)</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="n">vvthin</span><span class="w"> </span><span class="o">*</span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">pattern</span><span class="p">(</span><span class="n">solid</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">color</span><span class="p">(</span><span class="n">white</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">省界颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">国界线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="s2">&#34;0 85 170&#34;</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">海岸线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="s2">&#34;0 85 170&#34;</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">秦岭淮河线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">小地图框格颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">比例尺和指北针颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">polygon</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span><span class="w"> </span><span class="n">fcolor</span><span class="p">(</span><span class="n">black</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">osize</span><span class="p">(</span><span class="n">vvthin</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">label</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">chinaprov40_label</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="w"> </span><span class="n">label</span><span class="p">(</span><span class="n">cname</span><span class="p">)</span><span class="w"> </span><span class="k">length</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">point</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">pointdata</span><span class="p">)</span><span class="w"> </span><span class="k">by</span><span class="p">(</span><span class="n">north</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    	</span><span class="n">fcolor</span><span class="p">(</span><span class="s2">&#34;227 26 28%30&#34;</span><span class="w"> </span><span class="s2">&#34;24 188 156%30&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">x</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">proportional</span><span class="p">(</span><span class="err">与秦岭淮河线的距离</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">legenda</span><span class="p">(</span><span class="k">on</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">leg</span><span class="p">(</span><span class="k">order</span><span class="p">(</span><span class="mi">7</span><span class="w"> </span><span class="s2">&#34;秦岭-淮河线&#34;</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="s2">&#34;北方工企业&#34;</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="s2">&#34;南方工企业&#34;</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ti</span><span class="p">(</span><span class="s2">&#34;2013 年中国工业企业与秦岭-淮河线的距离&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="p">(</span><span class="n">black</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">subti</span><span class="p">(</span><span class="s2">&#34;二级标题&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">graphr</span><span class="p">(</span><span class="n">margin</span><span class="p">(</span><span class="n">medium</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">caption</span><span class="p">(</span><span class="s2">&#34;数据来源：2013 年中国工业企业数据库，使用高德地图地理编码接口解析经纬度&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gr</span><span class="w"> </span><span class="n">export</span><span class="w"> </span><span class="n">pic4</span><span class="p">.</span><span class="n">png</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="n">width</span><span class="p">(</span><span class="mi">1200</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">*</span><span class="w"> </span><span class="mi">2019</span><span class="w"> </span><span class="err">年中国各省地区生产总值</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="err">产业结构</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">use</span><span class="w"> </span><span class="err">各省历年</span><span class="n">GDP</span><span class="p">,</span><span class="w"> </span><span class="n">clear</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">drop</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="err">省份</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;中国&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">replace</span><span class="w"> </span><span class="err">地区生产总值</span><span class="n">_亿元</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">地区生产总值</span><span class="n">_亿元</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">merge</span><span class="w"> </span><span class="n">m</span><span class="p">:</span><span class="n">m</span><span class="w"> </span><span class="err">省代码</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">chinaprov40_db</span><span class="p">.</span><span class="n">dta</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">replace</span><span class="w"> </span><span class="err">地区生产总值</span><span class="n">_亿元</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">missing</span><span class="p">(</span><span class="err">年份</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">grmap</span><span class="w"> </span><span class="err">地区生产总值</span><span class="n">_亿元</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="err">年份</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2019</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">missing</span><span class="p">(</span><span class="err">年份</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">using</span><span class="w"> </span><span class="n">chinaprov40_coord</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">clmethod</span><span class="p">(</span><span class="n">custom</span><span class="p">)</span><span class="w"> </span><span class="n">clbreaks</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">80</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="mi">120</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">fcolor</span><span class="p">(</span><span class="s2">&#34;gray&#34;</span><span class="w"> </span><span class="s2">&#34;237 248 233&#34;</span><span class="w"> </span><span class="s2">&#34;199 233 192&#34;</span><span class="w"> </span><span class="s2">&#34;161 217 155&#34;</span><span class="w"> </span><span class="s2">&#34;116 196 118&#34;</span><span class="w"> </span><span class="s2">&#34;49 163 84&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">ocolor</span><span class="p">(</span><span class="s2">&#34;gray&#34;</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">ti</span><span class="p">(</span><span class="s2">&#34;2019 年中国各省地区生产总值 &amp; 产业结构&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">subtitle</span><span class="p">(</span><span class="s2">&#34;数据来源：CSMAR经济金融数据库&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">graphr</span><span class="p">(</span><span class="n">margin</span><span class="p">(</span><span class="n">medium</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">osize</span><span class="p">(</span><span class="n">vvthin</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">legend</span><span class="p">(</span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">order</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="s2">&#34;无数据&#34;</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="s2">&#34;&lt; 40千亿&#34;</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="mi">4</span><span class="w"> </span><span class="s2">&#34;40～60千亿&#34;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="s2">&#34;60～80千亿&#34;</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="mi">6</span><span class="w"> </span><span class="s2">&#34;80～100千亿&#34;</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="s2">&#34;&gt; 100千亿&#34;</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="mi">14</span><span class="w"> </span><span class="s2">&#34;第一产业&#34;</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="s2">&#34;第二产业&#34;</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="s2">&#34;第三产业&#34;</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">caption</span><span class="p">(</span><span class="s2">&#34;二级标题&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">line</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">chinaprov40_line_coord</span><span class="p">.</span><span class="n">dta</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="o">///</span><span class="w"> </span><span class="err">去除秦岭淮河线</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="err">胡焕庸线（</span><span class="mi">7</span><span class="err">）</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">select</span><span class="p">(</span><span class="n">keep</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">inlist</span><span class="p">(</span><span class="k">group</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">by</span><span class="p">(</span><span class="k">group</span><span class="p">)</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="n">vvthin</span><span class="w"> </span><span class="o">*</span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">pattern</span><span class="p">(</span><span class="n">solid</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">color</span><span class="p">(</span><span class="n">white</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">省界颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">国界线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="s2">&#34;0 85 170&#34;</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">海岸线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">小地图框格颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">比例尺和指北针颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">polygon</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span><span class="w"> </span><span class="n">fcolor</span><span class="p">(</span><span class="n">black</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">osize</span><span class="p">(</span><span class="n">vvthin</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">label</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">chinaprov40_label</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="w"> </span><span class="n">label</span><span class="p">(</span><span class="n">cname</span><span class="p">)</span><span class="w"> </span><span class="k">length</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">diagram</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">piedata</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="err">第一产业占</span><span class="n">GDP比重_百分比</span><span class="w"> </span><span class="err">第二产业占</span><span class="n">GDP比重_百分比</span><span class="w"> </span><span class="err">第三产业占</span><span class="n">GDP比重_百分比</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">type</span><span class="p">(</span><span class="n">pie</span><span class="p">)</span><span class="w"> </span><span class="n">legenda</span><span class="p">(</span><span class="k">on</span><span class="p">)</span><span class="w"> </span><span class="n">os</span><span class="p">(</span><span class="n">vvthin</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">size</span><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="n">fc</span><span class="p">(</span><span class="s2">&#34;102 194 165&#34;</span><span class="w"> </span><span class="s2">&#34;252 141 98&#34;</span><span class="w"> </span><span class="s2">&#34;229 196 148&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">oc</span><span class="p">(</span><span class="s2">&#34;102 194 165&#34;</span><span class="w"> </span><span class="s2">&#34;252 141 98&#34;</span><span class="w"> </span><span class="s2">&#34;229 196 148&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gr</span><span class="w"> </span><span class="n">export</span><span class="w"> </span><span class="s2">&#34;pic5.png&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="n">width</span><span class="p">(</span><span class="mi">1200</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">grmap</span><span class="w"> </span><span class="err">地区生产总值</span><span class="n">_亿元</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="err">年份</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2019</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">missing</span><span class="p">(</span><span class="err">年份</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">using</span><span class="w"> </span><span class="n">chinaprov40_coord</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">clmethod</span><span class="p">(</span><span class="n">custom</span><span class="p">)</span><span class="w"> </span><span class="n">clbreaks</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">80</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="mi">120</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">fcolor</span><span class="p">(</span><span class="s2">&#34;gray&#34;</span><span class="w"> </span><span class="s2">&#34;237 248 233&#34;</span><span class="w"> </span><span class="s2">&#34;199 233 192&#34;</span><span class="w"> </span><span class="s2">&#34;161 217 155&#34;</span><span class="w"> </span><span class="s2">&#34;116 196 118&#34;</span><span class="w"> </span><span class="s2">&#34;49 163 84&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">ocolor</span><span class="p">(</span><span class="s2">&#34;gray&#34;</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">ti</span><span class="p">(</span><span class="s2">&#34;2019 年中国各省地区生产总值 &amp; 第一产业比重&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">subtitle</span><span class="p">(</span><span class="s2">&#34;数据来源：CSMAR经济金融数据库&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">graphr</span><span class="p">(</span><span class="n">margin</span><span class="p">(</span><span class="n">medium</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">osize</span><span class="p">(</span><span class="n">vvthin</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">legend</span><span class="p">(</span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">order</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="s2">&#34;无数据&#34;</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="s2">&#34;&lt; 40千亿&#34;</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="mi">4</span><span class="w"> </span><span class="s2">&#34;40～60千亿&#34;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="s2">&#34;60～80千亿&#34;</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="mi">6</span><span class="w"> </span><span class="s2">&#34;80～100千亿&#34;</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="s2">&#34;&gt; 100千亿&#34;</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="mi">15</span><span class="w"> </span><span class="s2">&#34;第一产业比重&#34;</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">caption</span><span class="p">(</span><span class="s2">&#34;二级标题&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">line</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">chinaprov40_line_coord</span><span class="p">.</span><span class="n">dta</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="o">///</span><span class="w"> </span><span class="err">去除秦岭淮河线</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="err">胡焕庸线（</span><span class="mi">7</span><span class="err">）</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">select</span><span class="p">(</span><span class="n">keep</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">inlist</span><span class="p">(</span><span class="k">group</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">by</span><span class="p">(</span><span class="k">group</span><span class="p">)</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="n">vvthin</span><span class="w"> </span><span class="o">*</span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">pattern</span><span class="p">(</span><span class="n">solid</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">color</span><span class="p">(</span><span class="n">white</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">省界颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">国界线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="s2">&#34;0 85 170&#34;</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">海岸线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">小地图框格颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">比例尺和指北针颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">polygon</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span><span class="w"> </span><span class="n">fcolor</span><span class="p">(</span><span class="n">black</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">osize</span><span class="p">(</span><span class="n">vvthin</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">diagram</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">piedata</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="err">第一产业占</span><span class="n">GDP比重_百分比</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">type</span><span class="p">(</span><span class="n">frect</span><span class="p">)</span><span class="w"> </span><span class="n">legenda</span><span class="p">(</span><span class="k">on</span><span class="p">)</span><span class="w"> </span><span class="n">os</span><span class="p">(</span><span class="n">vvthin</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">size</span><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="n">fc</span><span class="p">(</span><span class="s2">&#34;252 141 98&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">oc</span><span class="p">(</span><span class="s2">&#34;252 141 98&#34;</span><span class="p">)</span><span class="w"> </span><span class="n">refsize</span><span class="p">(</span><span class="k">none</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gr</span><span class="w"> </span><span class="n">export</span><span class="w"> </span><span class="s2">&#34;pic6.png&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="n">width</span><span class="p">(</span><span class="mi">1200</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">*</span><span class="w"> </span><span class="err">各省人口密度</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">use</span><span class="w"> </span><span class="err">中国人口空间分布省级面板数据集</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="n">clear</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ren</span><span class="w"> </span><span class="err">省份</span><span class="w"> </span><span class="err">省</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">merge</span><span class="w"> </span><span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="w"> </span><span class="err">省</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">chinaprov40_db</span><span class="p">.</span><span class="n">dta</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">keep</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="err">年份</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2015</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">missing</span><span class="p">(</span><span class="err">年份</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">replace</span><span class="w"> </span><span class="err">均值</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">missing</span><span class="p">(</span><span class="err">均值</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">grmap</span><span class="w"> </span><span class="err">均值</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">chinaprov40_coord</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">id</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="w"> </span><span class="n">osize</span><span class="p">(</span><span class="n">vvthin</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="n">ocolor</span><span class="p">(</span><span class="n">white</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">clmethod</span><span class="p">(</span><span class="n">custom</span><span class="p">)</span><span class="w"> </span><span class="n">clbreaks</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="mi">2000</span><span class="w"> </span><span class="mi">3000</span><span class="w"> </span><span class="mi">4000</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">fcolor</span><span class="p">(</span><span class="n">gray</span><span class="w"> </span><span class="s2">&#34;224 242 241&#34;</span><span class="w"> </span><span class="s2">&#34;178 223 219&#34;</span><span class="w"> </span><span class="s2">&#34;128 203 196&#34;</span><span class="w"> </span><span class="s2">&#34;77 182 172&#34;</span><span class="w"> </span><span class="s2">&#34;38 166 154&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">leg</span><span class="p">(</span><span class="k">order</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="s2">&#34;无数据&#34;</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="s2">&#34;&lt; 100 人/平方公里&#34;</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="s2">&#34;100～1000 人/平方公里&#34;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="s2">&#34;1000～2000 人/平方公里&#34;</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="s2">&#34;2000～3000 人/平方公里&#34;</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="s2">&#34;&gt; 3000 人/平方公里&#34;</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="s2">&#34;胡焕庸线&#34;</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">graphr</span><span class="p">(</span><span class="n">margin</span><span class="p">(</span><span class="n">medium</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">line</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">chinaprov40_line_coord</span><span class="p">.</span><span class="n">dta</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="o">///</span><span class="w"> </span><span class="err">去除秦岭淮河线</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">select</span><span class="p">(</span><span class="n">keep</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">inlist</span><span class="p">(</span><span class="k">group</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">by</span><span class="p">(</span><span class="k">group</span><span class="p">)</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="n">vvthin</span><span class="w"> </span><span class="o">*</span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">pattern</span><span class="p">(</span><span class="n">solid</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">color</span><span class="p">(</span><span class="n">white</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">省界颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">国界线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="s2">&#34;0 85 170&#34;</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">海岸线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">小地图框格颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">比例尺和指北针颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="s2">&#34;227 26 28&#34;</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">胡焕庸线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">polygon</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span><span class="w"> </span><span class="n">fcolor</span><span class="p">(</span><span class="n">black</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">osize</span><span class="p">(</span><span class="n">vvthin</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">label</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">chinaprov40_label</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="w"> </span><span class="n">label</span><span class="p">(</span><span class="n">cname</span><span class="p">)</span><span class="w"> </span><span class="k">length</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">ti</span><span class="p">(</span><span class="s2">&#34;2015 年中国各省平均人口密度&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">subti</span><span class="p">(</span><span class="s2">&#34;二级标题&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">caption</span><span class="p">(</span><span class="s2">&#34;数据来源：中国科学院资源环境科学与数据中心&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gr</span><span class="w"> </span><span class="n">export</span><span class="w"> </span><span class="n">pic7</span><span class="p">.</span><span class="n">png</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="n">width</span><span class="p">(</span><span class="mi">1200</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="调节指南针和图例">调节指南针和图例</h3>
<p>通过识别相应数据的标识，更改坐标数实现更改效果。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">*</span><span class="w"> </span><span class="err">移动指北针的位置到右上方</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">use</span><span class="w"> </span><span class="n">chinaprov40_line_db</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="n">clear</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">*</span><span class="w"> </span><span class="err">指北针对应的</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="err">是</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="err">和</span><span class="w"> </span><span class="mi">41</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">use</span><span class="w"> </span><span class="n">chinaprov40_line_coord</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="n">clear</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">replace</span><span class="w"> </span><span class="n">_X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_X</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3000000</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">inlist</span><span class="p">(</span><span class="n">_ID</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">41</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">replace</span><span class="w"> </span><span class="n">_Y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_Y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4000000</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">inlist</span><span class="p">(</span><span class="n">_ID</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mi">41</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">save</span><span class="w"> </span><span class="n">chinaprov40_line_coord2</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">use</span><span class="w"> </span><span class="n">polygon</span><span class="p">,</span><span class="w"> </span><span class="n">clear</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">replace</span><span class="w"> </span><span class="n">_X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_X</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3000000</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">_ID</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">38</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">replace</span><span class="w"> </span><span class="n">_Y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_Y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4000000</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">_ID</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">38</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">save</span><span class="w"> </span><span class="n">polygon2</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">use</span><span class="w"> </span><span class="n">chinaprov40_label</span><span class="p">,</span><span class="w"> </span><span class="n">clear</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">replace</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3000000</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">cname</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;N&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">replace</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4000000</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">cname</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;N&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">save</span><span class="w"> </span><span class="n">chinaprov40_label2</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">use</span><span class="w"> </span><span class="n">chinaprov40_db</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="n">clear</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">encode</span><span class="w"> </span><span class="err">类型</span><span class="p">,</span><span class="w"> </span><span class="n">gen</span><span class="p">(</span><span class="k">type</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">grmap</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">chinaprov40_coord</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">id</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="w"> </span><span class="n">osize</span><span class="p">(</span><span class="n">vvthin</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="n">ocolor</span><span class="p">(</span><span class="n">white</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">clmethod</span><span class="p">(</span><span class="n">custom</span><span class="p">)</span><span class="w"> </span><span class="n">clbreaks</span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">fcolor</span><span class="p">(</span><span class="s2">&#34;254 212 57&#34;</span><span class="w"> </span><span class="s2">&#34;253 116 70&#34;</span><span class="w"> </span><span class="s2">&#34;138 145 151&#34;</span><span class="w"> </span><span class="s2">&#34;213 228 162&#34;</span><span class="w"> </span><span class="s2">&#34;210 175 129&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">leg</span><span class="p">(</span><span class="k">order</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="s2">&#34;不统计&#34;</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="s2">&#34;特别行政区&#34;</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="s2">&#34;直辖市&#34;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="s2">&#34;省&#34;</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="s2">&#34;自治区&#34;</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="s2">&#34;秦岭-淮河线&#34;</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="s2">&#34;胡焕庸线&#34;</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">graphr</span><span class="p">(</span><span class="n">margin</span><span class="p">(</span><span class="n">medium</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">line</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">chinaprov40_line_coord2</span><span class="p">.</span><span class="n">dta</span><span class="p">)</span><span class="w"> </span><span class="k">by</span><span class="p">(</span><span class="k">group</span><span class="p">)</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="n">vvthin</span><span class="w"> </span><span class="o">*</span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">pattern</span><span class="p">(</span><span class="n">solid</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">color</span><span class="p">(</span><span class="n">white</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">省界颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">国界线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="s2">&#34;0 85 170&#34;</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">海岸线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="s2">&#34;24 188 156&#34;</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">秦岭淮河线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">小地图框格颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">比例尺和指北针颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="s2">&#34;227 26 28&#34;</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">胡焕庸线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">polygon</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">polygon2</span><span class="p">)</span><span class="w"> </span><span class="n">fcolor</span><span class="p">(</span><span class="n">black</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">osize</span><span class="p">(</span><span class="n">vvthin</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">label</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">chinaprov40_label2</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="w"> </span><span class="n">label</span><span class="p">(</span><span class="n">cname</span><span class="p">)</span><span class="w"> </span><span class="k">length</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">ti</span><span class="p">(</span><span class="s2">&#34;使用 Stata 绘制 2019 年中国省级行政区划&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">subti</span><span class="p">(</span><span class="s2">&#34;二级标题&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">caption</span><span class="p">(</span><span class="s2">&#34;版本：使用 Stata 绘制中国省级地图数据包 4.0&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gr</span><span class="w"> </span><span class="n">export</span><span class="w"> </span><span class="n">pic8</span><span class="p">.</span><span class="n">png</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="n">width</span><span class="p">(</span><span class="mi">1200</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">*</span><span class="w"> </span><span class="err">调节比例尺的位置（微微上移）</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">use</span><span class="w"> </span><span class="n">chinaprov40_line_db</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="n">clear</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">*</span><span class="w"> </span><span class="err">比例尺对应的</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="err">是</span><span class="w"> </span><span class="mi">42</span><span class="w"> </span><span class="err">和</span><span class="w"> </span><span class="mi">43</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">use</span><span class="w"> </span><span class="n">chinaprov40_line_coord2</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="n">clear</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">replace</span><span class="w"> </span><span class="n">_Y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_Y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">200000</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">inlist</span><span class="p">(</span><span class="n">_ID</span><span class="p">,</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span><span class="w"> </span><span class="mi">43</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">save</span><span class="w"> </span><span class="n">chinaprov40_line_coord3</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">use</span><span class="w"> </span><span class="n">polygon2</span><span class="p">,</span><span class="w"> </span><span class="n">clear</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">replace</span><span class="w"> </span><span class="n">_Y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_Y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">200000</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">_ID</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">39</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">save</span><span class="w"> </span><span class="n">polygon3</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">use</span><span class="w"> </span><span class="n">chinaprov40_label2</span><span class="p">,</span><span class="w"> </span><span class="n">clear</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">replace</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">200000</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">cname</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&#34;1000km&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">save</span><span class="w"> </span><span class="n">chinaprov40_label3</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">use</span><span class="w"> </span><span class="n">chinaprov40_db</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="n">clear</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">encode</span><span class="w"> </span><span class="err">类型</span><span class="p">,</span><span class="w"> </span><span class="n">gen</span><span class="p">(</span><span class="k">type</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">grmap</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">chinaprov40_coord</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">id</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="w"> </span><span class="n">osize</span><span class="p">(</span><span class="n">vvthin</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="n">ocolor</span><span class="p">(</span><span class="n">white</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">clmethod</span><span class="p">(</span><span class="n">custom</span><span class="p">)</span><span class="w"> </span><span class="n">clbreaks</span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">fcolor</span><span class="p">(</span><span class="s2">&#34;254 212 57&#34;</span><span class="w"> </span><span class="s2">&#34;253 116 70&#34;</span><span class="w"> </span><span class="s2">&#34;138 145 151&#34;</span><span class="w"> </span><span class="s2">&#34;213 228 162&#34;</span><span class="w"> </span><span class="s2">&#34;210 175 129&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">leg</span><span class="p">(</span><span class="k">order</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="s2">&#34;不统计&#34;</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="s2">&#34;特别行政区&#34;</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="s2">&#34;直辖市&#34;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="s2">&#34;省&#34;</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="s2">&#34;自治区&#34;</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="s2">&#34;秦岭-淮河线&#34;</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="s2">&#34;胡焕庸线&#34;</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">graphr</span><span class="p">(</span><span class="n">margin</span><span class="p">(</span><span class="n">medium</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">line</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">chinaprov40_line_coord3</span><span class="p">.</span><span class="n">dta</span><span class="p">)</span><span class="w"> </span><span class="k">by</span><span class="p">(</span><span class="k">group</span><span class="p">)</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="n">vvthin</span><span class="w"> </span><span class="o">*</span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">pattern</span><span class="p">(</span><span class="n">solid</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">color</span><span class="p">(</span><span class="n">white</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">省界颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">国界线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="s2">&#34;0 85 170&#34;</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">海岸线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="s2">&#34;24 188 156&#34;</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">秦岭淮河线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">小地图框格颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="n">black</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">比例尺和指北针颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="s2">&#34;227 26 28&#34;</span><span class="w"> </span><span class="o">///</span><span class="w"> </span><span class="err">胡焕庸线颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			  </span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">polygon</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">polygon3</span><span class="p">)</span><span class="w"> </span><span class="n">fcolor</span><span class="p">(</span><span class="n">black</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">osize</span><span class="p">(</span><span class="n">vvthin</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">label</span><span class="p">(</span><span class="k">data</span><span class="p">(</span><span class="n">chinaprov40_label3</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="w"> </span><span class="n">label</span><span class="p">(</span><span class="n">cname</span><span class="p">)</span><span class="w"> </span><span class="k">length</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">ti</span><span class="p">(</span><span class="s2">&#34;使用 Stata 绘制 2019 年中国省级行政区划&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">subti</span><span class="p">(</span><span class="s2">&#34;二级标题&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">///</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">caption</span><span class="p">(</span><span class="s2">&#34;版本：使用 Stata 绘制中国省级地图数据包 4.0&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gr</span><span class="w"> </span><span class="n">export</span><span class="w"> </span><span class="n">pic9</span><span class="p">.</span><span class="n">png</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="n">width</span><span class="p">(</span><span class="mi">1200</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="国内市级">国内市级</h2>
<p>参考 <a href="https://zhuanlan.zhihu.com/p/591146315" target="_blank" rel="noopener noreffer ">Stata学习：如何绘制省级市级填色地图十段线版？</a></p>
<p>
<figure class="center-figure"><a class="lightgallery" href="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132320168.webp" title="Using machine learning to model technological heterogeneity in carbon  emission efficiency evaluation: The case of China’s cities " data-thumbnail="/img/Stata绘制Gis着色图.zh-cn-20240523132320168.webp" data-sub-html="<h2> </h2><p>Using machine learning to model technological heterogeneity in carbon  emission efficiency evaluation: The case of China’s cities </p>">
        <img
            class="lazyload center-image"
            src="/svg/loading.min.svg"
            data-src="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132320168.webp"
            data-srcset="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132320168.webp, /img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132320168.webp 1.5x, /img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132320168.webp 2x"
            data-sizes="auto"
            alt="/img/Stata绘制Gis着色图.zh-cn-20240523132320168.webp" />
    </a><figcaption class="image-caption">Using machine learning to model technological heterogeneity in carbon  emission efficiency evaluation: The case of China’s cities </figcaption>
    </figure></p>
<p>扒了下论文数据源</p>
<p>不过我使用时，地图命令使用的是 <code>grmap</code>，换成我的数据后莫名报错 <code>r(198),option t() required </code>，按理说是缺少逗号或者括号，但是检查了下没问题，换成 <code>spmap</code> 就行了，两者语法没有区别，可以直接更换。</p>
<h2 id="国内县级">国内县级</h2>
<p>同上，略</p>
<h2 id="geoplot-命令">Geoplot 命令</h2>
<p>和 <code>spmap</code> 和 <code>grmap</code> 相比命令更加简洁，定义功能更多，<a href="https://www.stata.com/meeting/uk23/slides/UK23_Jann.pdf" target="_blank" rel="noopener noreffer ">Ben Jann (University of Bern)</a></p>
<p><a href="https://github.com/benjann/geoplot" target="_blank" rel="noopener noreffer ">数据源</a></p>
<p><a href="https://medium.com/the-stata-guide/maps-in-stata-iii-geoplot-a764cf42688a" target="_blank" rel="noopener noreffer ">推荐教程</a></p>
<h3 id="下载相关命令-1">下载相关命令</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">clear</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ssc</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">geoplot</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ssc</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">palettes</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ssc</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">colrspace</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ssc</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">moremata</span><span class="p">,</span><span class="w"> </span><span class="k">replace</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="载入数据">载入数据</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">cd</span><span class="w"> </span><span class="n">F</span><span class="p">:</span><span class="err">\桌面\</span><span class="n">GIS_sum</span><span class="err">\</span><span class="n">geoplot</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">local</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">fmwww</span><span class="p">.</span><span class="n">bc</span><span class="p">.</span><span class="n">edu</span><span class="o">/</span><span class="n">repec</span><span class="o">/</span><span class="n">bocode</span><span class="o">/</span><span class="n">i</span><span class="o">/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">geoframe</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="n">regions</span><span class="w">  </span><span class="o">`</span><span class="n">url</span><span class="s1">&#39;Italy-RegionsData.dta, id(id) coord(xcoord ycoord) ///
</span></span></span><span class="line"><span class="cl"><span class="s1">shpfile(Italy-RegionsCoordinates.dta)
</span></span></span><span class="line"><span class="cl"><span class="s1">geoframe create country  `url&#39;</span><span class="n">Italy</span><span class="o">-</span><span class="n">OutlineCoordinates</span><span class="p">.</span><span class="n">dta</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">geoframe</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="n">capitals</span><span class="w"> </span><span class="o">`</span><span class="n">url</span><span class="s1">&#39;Italy-Capitals.dta, coord(xcoord ycoord)
</span></span></span><span class="line"><span class="cl"><span class="s1">geoframe create lakes    `url&#39;</span><span class="n">Italy</span><span class="o">-</span><span class="n">Lakes</span><span class="p">.</span><span class="n">dta</span><span class="p">,</span><span class="w"> </span><span class="n">feature</span><span class="p">(</span><span class="n">water</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">geoframe</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="n">rivers</span><span class="w">   </span><span class="o">`</span><span class="n">url</span><span class="s1">&#39;Italy-Rivers.dta, feature(water)
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>含义解释：</p>
<blockquote>
<p>Geoframe create 调用名字地图标签文件和, id (独特标识) coord (经度纬度) ///
Shpfile (地图轮廓文件)</p>
<p>每一个宏定义代表一个图层。</p>
<p>通过这种宏定义，下次只用调用名字就可以画图，省时省力。</p>
</blockquote>
<h3 id="画图">画图</h3>
<h4 id="基本命令">基本命令</h4>
<p>命令优势在于使用简单的括号就满足了图层叠加</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">geoplot (area regions fortell, label(&#34;@lb-@ub (N=@n)&#34;)) (line regions)
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<ul>
<li><code>area</code> 表示这里是画区域图，使用 regions 宏名字的地图轮廓，绘图变量是 fortell</li>
<li><code>label</code>：在地图中，这些变量将被替换为实际的数值。例如，如果某个区域的下限值为 <code>20</code>，上限值为 <code>50</code>，并且该区域包含 <code>100</code> 个单元格，则最终的标签将显示为 <code>&quot;20-50 (N=100)&quot;</code>。</li>
<li><code>@lb</code>：代表每个区域的下限值。</li>
<li><code>@ub</code>：代表每个区域的上限值。</li>
<li><code>@n</code>：代表每个区域的数量。</li>
<li><code>line</code> 表示线图调用 regions 的线图</li>
</ul>
</blockquote>
<h4 id="气泡图">气泡图</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">	geoplot ///
</span></span><span class="line"><span class="cl">    (area regions) ///
</span></span><span class="line"><span class="cl">    (point capitals i.size [w=pop98], color(Set1, opacity(50)) mlcolor(%0)) ///
</span></span><span class="line"><span class="cl">    (label capitals city if pop98&gt;250000, color(black)) ///
</span></span><span class="line"><span class="cl">    , legend compass sbar(length(300) units(km))
</span></span></code></pre></td></tr></table>
</div>
</div><p>
<figure class="center-figure"><a class="lightgallery" href="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132340342.webp" title="气泡图" data-thumbnail="/img/Stata绘制Gis着色图.zh-cn-20240523132340342.webp" data-sub-html="<h2> </h2><p>气泡图</p>">
        <img
            class="lazyload center-image"
            src="/svg/loading.min.svg"
            data-src="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132340342.webp"
            data-srcset="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132340342.webp, /img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132340342.webp 1.5x, /img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132340342.webp 2x"
            data-sizes="auto"
            alt="/img/Stata绘制Gis着色图.zh-cn-20240523132340342.webp" />
    </a><figcaption class="image-caption">气泡图</figcaption>
    </figure></p>
<ol>
<li><code>(area regions)</code>：绘制地图区域，表示地理区域的边界或范围。</li>
<li><code>(point capitals i.size [w=pop98], color(Set1, opacity(50)) mlcolor(%0))</code>：绘制城市的散点图，其中城市的大小由 <code>i.size</code> 决定，颜色使用 <code>Set1</code> 调色板，不透明度设置为 <code>50%</code>，并且城市标签的颜色为 <code>%0</code>，即黑色。城市的大小基于 <code>pop98</code> 变量，表示城市的人口数量。</li>
<li><code>(label capitals city if pop98&gt;250000, color(black))</code>：标记城市的名称，但只针对人口数量超过 <code>250,000</code> 的城市进行标记，标签颜色为黑色。</li>
<li><code>, legend compass sbar(length(300) units(km))</code>：添加图例、指南针和比例尺。比例尺的长度设置为 <code>300</code> 单位，单位为公里。</li>
</ol>
<h4 id="局部放大图">局部放大图</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">geoplot</span><span class="w"> </span><span class="p">(</span><span class="n">area</span><span class="w"> </span><span class="n">regions</span><span class="p">)</span><span class="w">                                           </span><span class="o">///</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="n">area</span><span class="w"> </span><span class="n">regions</span><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="n">id</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">fc</span><span class="p">(</span><span class="n">Coral</span><span class="o">*</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="n">lc</span><span class="p">(</span><span class="n">gray</span><span class="p">))</span><span class="w">       </span><span class="o">///</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="n">regions</span><span class="w"> </span><span class="n">region</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">id</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="p">(</span><span class="n">black</span><span class="p">))</span><span class="w">                </span><span class="o">///</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="n">area</span><span class="w"> </span><span class="n">regions</span><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="n">id</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">fc</span><span class="p">(</span><span class="n">Coral</span><span class="p">)</span><span class="w"> </span><span class="n">lc</span><span class="p">(</span><span class="n">gray</span><span class="p">)</span><span class="w"> </span><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">                                 */</span><span class="w"> </span><span class="n">box</span><span class="p">(</span><span class="n">circle</span><span class="w"> </span><span class="k">pad</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="n">fc</span><span class="p">(</span><span class="n">gs14</span><span class="p">)))</span><span class="w"> </span><span class="o">///</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="n">pie</span><span class="w"> </span><span class="n">regions</span><span class="w"> </span><span class="n">relig1</span><span class="w"> </span><span class="n">relig2</span><span class="w"> </span><span class="n">relig3</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">id</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">lab</span><span class="p">(,</span><span class="w"> </span><span class="n">reverse</span><span class="p">))</span><span class="w">  </span><span class="o">///</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="p">(</span><span class="n">pos</span><span class="p">(</span><span class="n">se</span><span class="p">)</span><span class="w"> </span><span class="n">rowgap</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="n">zoom</span><span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">90</span><span class="w"> </span><span class="mi">210</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>(area regions)</code>：绘制地图区域，表示地理区域的边界或范围。</li>
<li><code>(area regions if id==1, fc(Coral*.5) lc(gray))</code>：根据条件 <code>id==1</code> 绘制特定区域的地图区域，填充颜色为 <code>Coral*.5</code>，边界线颜色为灰色。</li>
<li><code>(label regions region if id==1, color(black))</code>：标记特定区域的名称，但只对 <code>id==1</code> 的区域进行标记，标签颜色为黑色。</li>
<li><code>(area regions if id==1, fc(Coral) lc(gray) /* ... */ box(circle pad(5) fc(gs14)))</code>：根据条件 <code>id==1</code> 绘制特定区域的地图区域，并在周围添加一个填充色为 <code>Coral</code> 的框，边界线颜色为灰色。</li>
<li><code>(pie regions relig1 relig2 relig3 if id==1, lab(, reverse))</code>：在特定区域绘制饼图，但只对 <code>id==1</code> 的区域进行绘制。饼图中包含 <code>relig1</code>、<code>relig2</code> 和 <code>relig3</code> 变量的数据，标签反向显示。</li>
<li><code>, legend(pos(se) rowgap(1))</code>：设置图例位置为东南方向，行间距为 <code>1</code>。</li>
<li><code>zoom(4/5: 6 90 210)</code>：设置地图的放大比例为 <code>4/5</code>，并指定地图显示的范围。

<figure class="center-figure"><a class="lightgallery" href="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132359071.webp" title="局部放大和饼图" data-thumbnail="/img/Stata绘制Gis着色图.zh-cn-20240523132359071.webp" data-sub-html="<h2> </h2><p>局部放大和饼图</p>">
        <img
            class="lazyload center-image"
            src="/svg/loading.min.svg"
            data-src="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132359071.webp"
            data-srcset="/img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132359071.webp, /img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132359071.webp 1.5x, /img/Stata%e7%bb%98%e5%88%b6Gis%e7%9d%80%e8%89%b2%e5%9b%be.zh-cn-20240523132359071.webp 2x"
            data-sizes="auto"
            alt="/img/Stata绘制Gis着色图.zh-cn-20240523132359071.webp" />
    </a><figcaption class="image-caption">局部放大和饼图</figcaption>
    </figure></li>
</ul>
<h2 id="地图使用规范">地图使用规范</h2>
<p><a href="https://www.gov.cn/gongbao/content/2023/content_5752310.htm" target="_blank" rel="noopener noreffer ">自然资源部关于印发《公开地图内容表示规范》的通知</a></p>
<p><a href="http://politics.people.com.cn/n1/2022/0830/c1001-32514471.html" target="_blank" rel="noopener noreffer ">规范使用地图 一点都不能错</a></p>
<p>省流：使用单个省份地图，街道乡镇地图还行，使用我国整体的地图是比较麻烦的。</p>
<ul>
<li>在使用我国整体地图时，比例画幅要求严格。</li>
<li>轮廓线，有些国界暂时未定或者每年有细微变动。</li>
<li>领土问题：香港、澳门、台湾、海南诸岛、钓鱼岛等等&hellip;</li>
<li>九段线最不能缺！</li>
<li>不能出现军工等机密数据的标注。</li>
<li>图例问题和指北针最好加上且和官方保持一致。</li>
</ul>
<p>针对期刊，最好参考：<a href="https://www.cjstp.cn/article/2021/1001-7143/1001-7143-32-6-699.shtml" target="_blank" rel="noopener noreffer ">科技期刊地图插图的规范绘制和常见问题</a></p>
<p>最官方的地图详见：<a href="http://bzdt.ch.mnr.gov.cn/index.html" target="_blank" rel="noopener noreffer ">标准地图服务</a>。自己画好地图后也可以在这里拿去送审。</p>
<blockquote>
<p>官方是不提供 shap 文件的，只提供 eps 和 jpg 文件。</p>
<p>市面上流行的 shap 官方文件都是个人制作，需要仔细辨别。</p>
</blockquote>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2024-03-22</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/zh-cn/posts/statagis/index.md" target="_blank">阅读原始文档</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://blog.huaxiangshan.com/zh-cn/posts/statagis/" data-title="Stata 绘制 Gis 着色图" data-hashtags="Stata,Gis"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://blog.huaxiangshan.com/zh-cn/posts/statagis/" data-hashtag="Stata"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Hacker News" data-sharer="hackernews" data-url="https://blog.huaxiangshan.com/zh-cn/posts/statagis/" data-title="Stata 绘制 Gis 着色图"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="https://blog.huaxiangshan.com/zh-cn/posts/statagis/" data-title="Stata 绘制 Gis 着色图"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://blog.huaxiangshan.com/zh-cn/posts/statagis/" data-title="Stata 绘制 Gis 着色图" data-image="/img/Stata绘制Gis着色图.zh-cn-20240523132359071.webp"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/zh-cn/tags/stata/">Stata</a>,&nbsp;<a href="/zh-cn/tags/gis/">GIS</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/zh-cn/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/zh-cn/posts/toc/" class="prev" rel="prev" title="中文博客目录跳转失败"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>中文博客目录跳转失败</a>
            <a href="/zh-cn/posts/fs/" class="next" rel="next" title="反思：鄙视链中的经济学习心态">反思：鄙视链中的经济学习心态<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="giscus" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://giscus.app">Giscus</a>.
            </noscript></div></article></div>
            </main><script>

(function() {
  console.log('[Music Player] Enhanced initialization script loaded');

  
  const CDN_SOURCES = [
    'https://cdn.jsdelivr.net/npm/',
    'https://unpkg.com/',
    'https://cdnjs.cloudflare.com/ajax/libs/'
  ];

  const APLAYER_CSS = 'aplayer@1.10.1/dist/APlayer.min.css';
  const APLAYER_JS = 'aplayer@1.10.1/dist/APlayer.min.js';
  const METING_JS = 'meting@2.0.1/dist/Meting.min.js';

  
  function safeHasMusicPlayers() {
    try {
      return document.querySelectorAll('meting-js').length > 0;
    } catch (e) {
      console.warn('[Music Player] Error checking for music players:', e);
      return false;
    }
  }

  function safeResourcesLoaded() {
    try {
      return typeof window.APlayer !== 'undefined' && typeof window.Meting !== 'undefined';
    } catch (e) {
      console.warn('[Music Player] Error checking resources:', e);
      return false;
    }
  }

  
  function loadResource(url, resourceType, retries = 2) {
    return new Promise((resolve, reject) => {
      const isCSS = resourceType === 'css';
      const isJS = resourceType === 'js';

      
      const existing = isCSS
        ? document.querySelector(`link[href*="${url.split('/').pop()}"]`)
        : document.querySelector(`script[src*="${url.split('/').pop()}"]`);

      if (existing) {
        console.log(`[Music Player] Resource already loaded: ${url}`);
        resolve();
        return;
      }

      const element = isCSS ? document.createElement('link') : document.createElement('script');

      if (isCSS) {
        element.rel = 'stylesheet';
        element.href = url;
      } else {
        element.src = url;
      }

      let attempts = 0;

      const attemptLoad = () => {
        attempts++;

        element.onload = () => {
          console.log(`[Music Player] Successfully loaded: ${url}`);
          resolve();
        };

        element.onerror = (err) => {
          console.warn(`[Music Player] Failed to load ${url} (attempt ${attempts}/${retries + 1})`);

          if (attempts <= retries) {
            
            const nextCDN = CDN_SOURCES.find(cdn => url.startsWith(cdn));
            if (nextCDN) {
              const nextUrl = url.replace(nextCDN, CDN_SOURCES[(CDN_SOURCES.indexOf(nextCDN) + 1) % CDN_SOURCES.length]);
              console.log(`[Music Player] Retrying with alternative CDN: ${nextUrl}`);
              if (isCSS) {
                element.href = nextUrl;
              } else {
                element.src = nextUrl;
              }
              setTimeout(attemptLoad, 500);
            } else {
              reject(err);
            }
          } else {
            reject(err);
          }
        };

        
        if (isCSS) {
          document.head.appendChild(element);
        } else {
          document.body.appendChild(element);
        }
      };

      attemptLoad();
    });
  }

  
  function loadDependencies() {
    console.log('[Music Player] Loading dependencies with fallback support...');

    
    const primaryCDN = CDN_SOURCES[0];

    return loadResource(primaryCDN + APLAYER_CSS, 'css', 1)
      .then(() => {
        console.log('[Music Player] APlayer CSS loaded');
        return loadResource(primaryCDN + APLAYER_JS, 'js', 1);
      })
      .then(() => {
        console.log('[Music Player] APlayer JS loaded');
        return loadResource(primaryCDN + METING_JS, 'js', 1);
      })
      .then(() => {
        console.log('[Music Player] All dependencies loaded successfully');
        return true;
      })
      .catch(async (err) => {
        console.error('[Music Player] Primary CDN failed, trying alternative CDNs:', err);

        
        for (let i = 1; i < CDN_SOURCES.length; i++) {
          try {
            const cdn = CDN_SOURCES[i];
            console.log(`[Music Player] Trying CDN: ${cdn}`);

            await loadResource(cdn + APLAYER_CSS, 'css', 0);
            await loadResource(cdn + APLAYER_JS, 'js', 0);
            await loadResource(cdn + METING_JS, 'js', 0);

            console.log('[Music Player] Successfully loaded from alternative CDN');
            return true;
          } catch (altErr) {
            console.warn(`[Music Player] CDN ${CDN_SOURCES[i]} failed:`, altErr);
            continue;
          }
        }

        console.error('[Music Player] All CDN attempts failed');
        return false;
      });
  }

  
  function initializePlayers() {
    try {
      if (!safeResourcesLoaded()) {
        console.error('[Music Player] Cannot initialize: dependencies not loaded');
        return false;
      }

      console.log('[Music Player] Initializing meting-js players...');
      let successCount = 0;
      let errorCount = 0;

      const players = document.querySelectorAll('meting-js');

      players.forEach(el => {
        try {
          if (el.hasAttribute('data-initialized')) {
            console.log('[Music Player] Player already initialized, skipping');
            return;
          }

          
          if (typeof window.Meting !== 'function') {
            throw new Error('Meting constructor not available');
          }

          new window.Meting(el);
          el.setAttribute('data-initialized', 'true');
          successCount++;
          console.log('[Music Player] Successfully initialized meting-js element');
        } catch (err) {
          errorCount++;
          console.error('[Music Player] Error initializing meting-js element:', err);
        }
      });

      console.log(`[Music Player] Initialization complete: ${successCount} successful, ${errorCount} failed`);

      
      if (successCount === 0 && players.length > 0) {
        console.log('[Music Player] No players initialized, scheduling retry...');
        setTimeout(() => {
          console.log('[Music Player] Retrying initialization...');
          initializePlayers();
        }, 1000);
      }

      return successCount > 0;
    } catch (error) {
      console.error('[Music Player] Fatal error during initialization:', error);
      return false;
    }
  }

  
  function initMusicPlayers() {
    console.log('[Music Player] Initialization triggered');

    try {
      if (!safeHasMusicPlayers()) {
        console.log('[Music Player] No meting-js elements found');
        return;
      }

      const playerCount = document.querySelectorAll('meting-js').length;
      console.log(`[Music Player] Found ${playerCount} meting-js element(s)`);

      
      if (safeResourcesLoaded()) {
        console.log('[Music Player] Resources already loaded, initializing...');
        setTimeout(() => initializePlayers(), 50);
        return;
      }

      
      const scripts = Array.from(document.querySelectorAll('script[src]'));
      const hasAPlayerScript = scripts.some(s => s.src.includes('APlayer.min.js'));
      const hasMetingScript = scripts.some(s => s.src.includes('Meting.min.js'));

      if (hasAPlayerScript || hasMetingScript) {
        console.log('[Music Player] Resources detected in DOM, waiting for load...');
        waitForResources();
        return;
      }

      
      console.log('[Music Player] Loading dependencies dynamically...');
      loadDependencies().then(success => {
        if (success) {
          console.log('[Music Player] Dependencies loaded, initializing players...');
          setTimeout(() => initializePlayers(), 100);
        } else {
          console.error('[Music Player] Failed to load dependencies, will retry in 2s');
          setTimeout(initMusicPlayers, 2000);
        }
      });
    } catch (error) {
      console.error('[Music Player] Error in initialization flow:', error);
    }
  }

  
  function waitForResources() {
    const maxWaitTime = 10000; 
    const checkInterval = 250;
    let elapsed = 0;
    let timeoutId = null;

    const check = () => {
      elapsed += checkInterval;

      if (safeResourcesLoaded()) {
        console.log(`[Music Player] Resources loaded after ${elapsed}ms`);
        setTimeout(() => initializePlayers(), 50);
        return;
      }

      if (elapsed >= maxWaitTime) {
        console.warn('[Music Player] Timeout waiting for resources, loading dynamically...');
        loadDependencies().then(success => {
          if (success) {
            setTimeout(() => initializePlayers(), 100);
          }
        });
        return;
      }

      timeoutId = setTimeout(check, checkInterval);
    };

    check();
  }

  
  function startInitialization() {
    
    setTimeout(initMusicPlayers, 100);
  }

  
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
      console.log('[Music Player] DOMContentLoaded event fired');
      startInitialization();
    });
  } else {
    console.log('[Music Player] DOM already loaded');
    startInitialization();
  }

  
  if (typeof document.addEventListener === 'function') {
    document.addEventListener('pjax:end', function() {
      console.log('[Music Player] PJAX navigation detected');
      setTimeout(initMusicPlayers, 100);
    });
  }

  
  document.addEventListener('visibilitychange', function() {
    if (!document.hidden) {
      setTimeout(() => {
        if (document.querySelectorAll('meting-js').length > 0 && !safeResourcesLoaded()) {
          console.log('[Music Player] Page visible again, checking music players...');
          initMusicPlayers();
        }
      }, 500);
    }
  });

  
  window.initMusicPlayers = initMusicPlayers;
  console.log('[Music Player] Initialization system ready');
})();
</script>



    
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-line">
                <span id="run-time" data-i18n="runtime"></span>
            </div><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreferrer" title="Hugo 0.122.0">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreferrer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div>

            <div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2024 - 2026</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/hzp2333/hzp2333.github.io" target="_blank">滑翔闪</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span>
            </div>

            <style>
                .footerImg {
                    height: 20px;
                }
            </style>
            <div class="footer-line custom">
                <a href="https://icp.gov.moe/?keyword=20244204" target="_blank">萌ICP备20244204号</a>
                <a style="text-decoration:none;color:#55bb8a;" href="https://travel.moe/go.html" title="异次元之旅-跃迁-我们一起去萌站成员的星球旅行吧！" target="_blank">
                    <img src="https://travel.moe/images/icon/icon64green.png" style="width:24px;height:24px" alt="异次元之旅">异次元之旅
                </a>
            </div>

            <div class="footer-line custom">
                <a href="https://www.travellings.cn/go.html" target="_blank">
                    <img src="https://www.travellings.cn/assets/logo.gif" class="footerImg" alt="开往-友链接力 v1.5" title="开往-友链接力 v1.5">
                </a>
                <a href="https://www.foreverblog.cn/" target="_blank">
                    <img src="https://foreverblog.cn/assets/logo/logo_en_default.png" class="footerImg" alt="Forever Blog">
                </a>
                <a href="https://www.foreverblog.cn/go.html" target="_blank">
                    <img src="https://foreverblog.cn/assets/logo/wormhole_2.gif" class="footerImg" alt="穿梭虫洞-随机访问十年之约友链博客" title="穿梭虫洞-随机访问十年之约友链博客">
                </a>
            </div><div class="footer-line">
  <i class="fas fa-book fa-fw" aria-hidden="true"></i>&nbsp;共 97 篇文章，346326 字</div>
    
        
        <script async src=" //busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js "></script>
    

    
        
            <section>
                
                    <span id="busuanzi_container_value_site_pv"><i class="far fa-eye fa-fw"></i>
                        
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                

                
                    &nbsp;|&nbsp;              
                

                
                    <span id="busuanzi_container_value_site_uv"><i class="fa fa-user"></i>
                        
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
            </section>
        

        
        
    


</div>
    </footer>
 

    
    <script src="https://cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js" 
        data-color="0,0,0" 
        data-count="150" 
        data-zIndex="-1">
    </script>
</body>
</html>



</div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.zh.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":50},"comment":{"giscus":{"category":"Announcements","categoryId":"DIC_kwDOLbBjxM4Cdr0n","darkTheme":"dark_dimmed","emitMetadata":"0","inputPosition":"bottom","lang":"zh-CN","lazyLoading":false,"lightTheme":"light","mapping":"pathname","reactionsEnabled":"1","repo":"hzp2333/Giscus","repoId":"R_kgDOLbBjxA"}},"data":{"id-1":"滑翔闪'S BLOG","id-2":"滑翔闪'S BLOG"},"lightgallery":true,"search":{"highlightTag":"em","lunrIndexURL":"/zh-cn/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"lunr"},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery@2.1.3/dist/jquery.min.js"></script><script type="text/javascript" src="/js/custom.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-CYZVM6VVZ8', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-CYZVM6VVZ8" async></script></body>
</html>
