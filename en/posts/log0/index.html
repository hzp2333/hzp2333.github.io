<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Econometrics: Is the Log (y&#43;1) Transformation Reliable? - 滑翔闪&#39;S BLOG</title><meta name="Description" content="This is my cool site"><meta property="og:title" content="Econometrics: Is the Log (y&#43;1) Transformation Reliable?" />
<meta property="og:description" content="Reading of the paper &ldquo;Logs with Zeros? Some Problems and Solutions&rdquo;. When the explanatory variable contains 0, the logarithmic transformation log (y&#43;1) has some limitations in estimating treatment effects." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.huaxiangshan.com/en/posts/log0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-05-12T17:59:49+08:00" />
<meta property="article:modified_time" content="2024-05-12T17:59:49+08:00" /><meta property="og:site_name" content="My cool site" />

<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Econometrics: Is the Log (y&#43;1) Transformation Reliable?"/>
<meta name="twitter:description" content="Reading of the paper &ldquo;Logs with Zeros? Some Problems and Solutions&rdquo;. When the explanatory variable contains 0, the logarithmic transformation log (y&#43;1) has some limitations in estimating treatment effects."/>
<meta name="twitter:site" content="@ygVNLSZ1omFBCeB"/>
<meta name="application-name" content="My cool site">
<meta name="apple-mobile-web-app-title" content="My cool site"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://blog.huaxiangshan.com/en/posts/log0/" /><link rel="prev" href="https://blog.huaxiangshan.com/en/posts/bff/" /><link rel="next" href="https://blog.huaxiangshan.com/en/posts/mycc/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Econometrics: Is the Log (y+1) Transformation Reliable?",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/blog.huaxiangshan.com\/en\/posts\/log0\/"
        },"genre": "posts","keywords": "Literature Review","wordcount":  1302 ,
        "url": "https:\/\/blog.huaxiangshan.com\/en\/posts\/log0\/","datePublished": "2024-05-12T17:59:49+08:00","dateModified": "2024-05-12T17:59:49+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "滑翔闪"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper">

<script>
window.MathJax = {
  tex: {
    inlineMath: [["$", "$"], ["\\(", "\\)"]],
    displayMath: [["$$","$$"], ["[[", "]]"]]
  },
  svg: { fontCache: "global" }
};

const mathjaxCDNs = [
  "https://cdn.bootcdn.net/ajax/libs/mathjax/3.2.2/es5/tex-chtml.js",
  "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js",
  "https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-chtml.js"
];

function loadMathJax(index=0){
  if(index >= mathjaxCDNs.length){
    console.error("所有 MathJax CDN 加载失败");
    return;
  }
  const script = document.createElement("script");
  script.src = mathjaxCDNs[index];
  script.async = true;
  script.onload = () => console.log("MathJax 加载成功:", mathjaxCDNs[index]);
  script.onerror = () => {
    console.warn("MathJax CDN 加载失败，尝试下一个:", mathjaxCDNs[index]);
    loadMathJax(index+1);
  };
  document.head.appendChild(script);
}


const polyfillCDNs = [
  "https://cdn.bootcdn.net/ajax/libs/polyfill/3.110.0/polyfill.min.js",
  "https://polyfill.io/v3/polyfill.min.js?features=es6"
];
const polyfillScript = document.createElement("script");
polyfillScript.src = polyfillCDNs[0]; 
document.head.appendChild(polyfillScript);


loadMathJax();
</script>












<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sakana 小组件集成</title>
  <style>
     
    #sakana-widget-container {
      position: fixed;
      bottom: 10px;
      left: 10px;
      width: 268px;
      height: 268px;
    }
    #sakana-widget {
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <div id="sakana-widget-container">
    <div id="sakana-widget"></div>
  </div>

  <script>
    function initSakanaWidget() {
      new SakanaWidget({
        size: 300,
        autoFit: true,
        character: 'chisato',
        controls: true,
        rod: true,
        draggable: true,
        stroke: { color: '#b4b4b4', width: 10 },
        threshold: 0.1,
        rotate: 0,
        title: false
      }).mount('#sakana-widget');

      
      checkScreenWidth();
      window.addEventListener('resize', checkScreenWidth);
    }

    function checkScreenWidth() {
      var screenWidth = window.innerWidth;
      var container = document.getElementById('sakana-widget-container');
      if (screenWidth <= 960) {
        container.style.display = 'none';
      } else {
        container.style.display = 'block';
      }
    }
  </script>

  
  <script 
    async
    onload="initSakanaWidget()"
    src="https://cdn.jsdelivr.net/npm/sakana-widget@2.2.2/lib/sakana.min.js">
  </script>
</body>
</html>




<script type="text/javascript" color="0,174,255" opacity='0.7' zIndex="-2" count="200" src="https://www.liuzehe.top/upload/bkjs/bj.js"></script><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/en/" title="滑翔闪&#39;S BLOG"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/%E7%9F%9B%E7%9B%BE.png"
        data-srcset="/images/%E7%9F%9B%E7%9B%BE.png, /images/%E7%9F%9B%E7%9B%BE.png 1.5x, /images/%E7%9F%9B%E7%9B%BE.png 2x"
        data-sizes="auto"
        alt="/images/%E7%9F%9B%E7%9B%BE.png"
        title="/images/%E7%9F%9B%E7%9B%BE.png" /><span id="id-3" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/en/posts/" title="The book has its own golden house"><i class='fa fa-solid fa-book'></i> Posts </a><a class="menu-item" href="/en/tags/" title="Tag the article, don’t tag the world"><i class='fa fa-tag'></i> Tags </a><a class="menu-item" href="/en/categories/" title="Classification is a virtue"><i class='fa fa-archive'></i> Categories </a><a class="menu-item" href="/en/friends/" title=" It is always a pleasure to greet a friend from afar "><i class='fa fa-user-group'></i> Friends </a><a class="menu-item" href="/en/about/" title="People spend their whole life searching for themselves"> <i class='fa fa-address-card'></i> About </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="I&#39;ll search with will" id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="Select Language">
                    <i class="fa fa-globe" aria-hidden="true"></i>                      
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/zh-cn/posts/log0/">简体中文</option><option value="/en/posts/log0/" selected>English</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/en/" title="滑翔闪&#39;S BLOG"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/%E7%9F%9B%E7%9B%BE.png"
        data-srcset="/images/%E7%9F%9B%E7%9B%BE.png, /images/%E7%9F%9B%E7%9B%BE.png 1.5x, /images/%E7%9F%9B%E7%9B%BE.png 2x"
        data-sizes="auto"
        alt="/images/%E7%9F%9B%E7%9B%BE.png"
        title="/images/%E7%9F%9B%E7%9B%BE.png" /><span id="id-4" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="I&#39;ll search with will" id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/en/posts/" title="The book has its own golden house"><i class='fa fa-solid fa-book'></i>Posts</a><a class="menu-item" href="/en/tags/" title="Tag the article, don’t tag the world"><i class='fa fa-tag'></i>Tags</a><a class="menu-item" href="/en/categories/" title="Classification is a virtue"><i class='fa fa-archive'></i>Categories</a><a class="menu-item" href="/en/friends/" title=" It is always a pleasure to greet a friend from afar "><i class='fa fa-user-group'></i>Friends</a><a class="menu-item" href="/en/about/" title="People spend their whole life searching for themselves"> <i class='fa fa-address-card'></i>About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Select Language">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/zh-cn/posts/log0/">简体中文</option><option value="/en/posts/log0/" selected>English</option></select>
                </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Econometrics: Is the Log (y+1) Transformation Reliable?</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://github.com/hzp2333/hzp2333.github.io" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>滑翔闪</a></span>&nbsp;<span class="post-category">included in <a href="/en/categories/economics-learning/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Economics Learning</a></span></div>

            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2024-05-12">2024-05-12</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1302 words
                <i class="far fa-clock fa-fw"></i>&nbsp;3 minutes&nbsp;
    

    
        

        
        
            <span id="busuanzi_container_value_page_pv"><i class="far fa-eye fa-fw"></i>
                
                <span id="busuanzi_value_page_pv"></span>&nbsp;views</span>
        
    


</div>

        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/img/%e5%8c%85%e5%90%ab0%e5%80%bc%e7%9a%84%e5%af%b9%e6%95%b0%e5%8c%96%e6%98%af%e5%90%a6%e5%8f%af%e9%9d%a0-20240523094150322.webp"
        data-srcset="/img/%e5%8c%85%e5%90%ab0%e5%80%bc%e7%9a%84%e5%af%b9%e6%95%b0%e5%8c%96%e6%98%af%e5%90%a6%e5%8f%af%e9%9d%a0-20240523094150322.webp, /img/%e5%8c%85%e5%90%ab0%e5%80%bc%e7%9a%84%e5%af%b9%e6%95%b0%e5%8c%96%e6%98%af%e5%90%a6%e5%8f%af%e9%9d%a0-20240523094150322.webp 1.5x, /img/%e5%8c%85%e5%90%ab0%e5%80%bc%e7%9a%84%e5%af%b9%e6%95%b0%e5%8c%96%e6%98%af%e5%90%a6%e5%8f%af%e9%9d%a0-20240523094150322.webp 2x"
        data-sizes="auto"
        alt="/img/包含0值的对数化是否可靠-20240523094150322.webp"
        title="/img/包含0值的对数化是否可靠-20240523094150322.webp" /></div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#abstract">Abstract</a></li>
    <li><a href="#summary">Summary</a></li>
    <li><a href="#code-example">Code Example</a></li>
    <li><a href="#explanation">Explanation</a>
      <ul>
        <li>
          <ul>
            <li><a href="#understanding-logarithmic-transformation">Understanding Logarithmic Transformation</a></li>
            <li><a href="#limitations-of-logarithmic-transformation">Limitations of Logarithmic Transformation</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#conclusion-and-solutions">Conclusion and Solutions</a>
      <ul>
        <li><a href="#conclusion">Conclusion</a></li>
        <li><a href="#solutions">Solutions</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="is-the-log-y1-transformation-reliable">Is the Log (y+1) Transformation Reliable?</h1>
<h2 id="abstract">Abstract</h2>
<table>
<thead>
<tr>
<th>Title: Logs with Zeros? Some Problems and Solutions</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Authors:</strong>  Jiafeng Chen; Jonathan Roth</td>
</tr>
<tr>
<td><strong>Journal:</strong>  The Quarterly Journal of Economics  （2024/3/30）</td>
</tr>
<tr>
<td><strong>DOI:</strong>  <a href="https://academic.oup.com/qje/article-abstract/139/2/891/7473710?redirectedFrom=fulltext" target="_blank" rel="noopener noreffer ">10.1093/qje/qjad054</a></td>
</tr>
<tr>
<td><strong>Abstract Translation:</strong>   When studying an outcome variable Y that can equal 0 (e.g., earnings), most researchers typically use a transformed average treatment effect (ATE) for estimation. This transformation can be represented as log (Y) when the outcome variable Y is large, and log (1 + Y) is usually used when Y equals 0. Our research finds that such logarithmic transformations of the average treatment effect should not be interpreted as percentage effects because the outcome itself is not a percentage, and the estimated average treatment effect depends on the units of the outcome variable. In fact, our study shows that if the actual units of Y are changed before performing a logarithmic transformation, treatment effects of any size can be obtained. This result arises because, for samples where the outcome changes from zero to non-zero during estimation, the percentage effect at the sample level is not well-defined, and the units of the outcome implicitly determine the weight given to the extensive margin in the logarithmic transformation of the average treatment effect. Further research reveals an &ldquo;impossible triangle&rdquo;: when the outcome variable can equal zero, it is impossible to simultaneously satisfy the estimation result as the sample&rsquo;s average treatment effect, keep the units of Y unchanged (or independent of unit changes), and achieve point identification. We discuss several alternative methods that may be reasonable and feasible in settings with both intensive and extensive margins, including (1) expressing the average treatment effect in percentage terms (e.g., using Poisson regression), (2) explicitly calibrating samples on the intensive and extensive margins, and (3) separately estimating the actual treatment effects on the extensive and intensive margins (e.g., using Lee bounds). We illustrate these methods in three empirical applications.</td>
</tr>
<tr>
<td></td>
</tr>
</tbody>
</table>
<h2 id="summary">Summary</h2>
<p>Discussion on whether <strong>logarithmic transformation with zero values</strong> is reliable, such as $log(1+y)$ and $arcsinh(y)=\sqrt{1+y^2}+y$.</p>
<h2 id="code-example">Code Example</h2>
<p>The code results show that when the data contains zeros, the regression significance can be affected by modifying the units of the logarithmically transformed $y$.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">sysuse</span><span class="w"> </span><span class="n">nlsw88</span><span class="p">,</span><span class="w"> </span><span class="n">clear</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">replace</span><span class="w"> </span><span class="n">wage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">_n</span><span class="o">&lt;=</span><span class="mi">400</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Change</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">wage</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="mi">400</span><span class="w"> </span><span class="n">observations</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gen</span><span class="w"> </span><span class="n">lnwage1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ln</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">.</span><span class="mi">128683</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">wage</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gen</span><span class="w"> </span><span class="n">lnwage2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ln</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">.</span><span class="mi">7744329</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">wage</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gen</span><span class="w"> </span><span class="n">lnwage3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ln</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">84</span><span class="p">.</span><span class="mi">02252</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">wage</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gen</span><span class="w"> </span><span class="n">lnwage4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ln</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="p">.</span><span class="mi">68</span><span class="n">e</span><span class="o">+</span><span class="mi">08</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">wage</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gen</span><span class="w"> </span><span class="n">lnwage5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ln</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="mi">77</span><span class="n">e</span><span class="o">+</span><span class="mi">25</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">wage</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">reg</span><span class="w"> </span><span class="n">lnwage1</span><span class="w"> </span><span class="n">tenure</span><span class="w"> </span><span class="n">grade</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">eststo</span><span class="w"> </span><span class="n">m1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">reg</span><span class="w"> </span><span class="n">lnwage2</span><span class="w"> </span><span class="n">tenure</span><span class="w"> </span><span class="n">grade</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">eststo</span><span class="w"> </span><span class="n">m2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">reg</span><span class="w"> </span><span class="n">lnwage3</span><span class="w"> </span><span class="n">tenure</span><span class="w"> </span><span class="n">grade</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">eststo</span><span class="w"> </span><span class="n">m3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">reg</span><span class="w"> </span><span class="n">lnwage4</span><span class="w"> </span><span class="n">tenure</span><span class="w"> </span><span class="n">grade</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">eststo</span><span class="w"> </span><span class="n">m4</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">reg</span><span class="w"> </span><span class="n">lnwage5</span><span class="w"> </span><span class="n">tenure</span><span class="w"> </span><span class="n">grade</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">eststo</span><span class="w"> </span><span class="n">m5</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">esttab</span><span class="w"> </span><span class="n">m1</span><span class="w"> </span><span class="n">m2</span><span class="w"> </span><span class="n">m3</span><span class="w"> </span><span class="n">m4</span><span class="w"> </span><span class="n">m5</span><span class="p">,</span><span class="w"> </span><span class="n">keep</span><span class="p">(</span><span class="n">tenure</span><span class="p">)</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="n">se</span><span class="w"> </span><span class="n">compress</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">/*-------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="cm">                 (1)          (2)          (3)          (4)          (5)   
</span></span></span><span class="line"><span class="cl"><span class="cm">             lnwage1      lnwage2      lnwage3      lnwage4      lnwage5   
</span></span></span><span class="line"><span class="cl"><span class="cm">---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="cm">tenure         0.010***     0.020***     0.030**      0.050        0.100   
</span></span></span><span class="line"><span class="cl"><span class="cm">             (0.001)      (0.003)      (0.010)      (0.032)      (0.090)   
</span></span></span><span class="line"><span class="cl"><span class="cm">---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="cm">N               2229         2229         2229         2229         2229   
</span></span></span><span class="line"><span class="cl"><span class="cm">---------------------------------------------------------------------------*/</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="explanation">Explanation</h2>
<h4 id="understanding-logarithmic-transformation">Understanding Logarithmic Transformation</h4>
<p>It is generally believed that the economic significance of logarithmic transformation reflects <strong>percentage changes</strong>.</p>
<div class="details admonition tip">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw" aria-hidden="true"></i>Meaning of Coefficients After Logarithmic Transformation<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>After taking the logarithm of a variable, it is generally believed that the coefficient reflects the percentage change. For example, lnGDP in a regression represents the percentage change in GDP. If it is <code>reg lny lnx</code>, the economic meaning of the coefficient is elasticity. See <a href="https://www.zhihu.com/question/27588499/answer/588450047" target="_blank" rel="noopener noreffer ">The Meaning of Taking Logarithms</a>.</p>
<p>For the following regression equation
$$
\ln y_n=\alpha+\beta x_n +\varepsilon
$$
the coefficient has the following economic meaning
$$
\begin{align}
\beta &amp; = \frac{\ln Y_{n+1}-\ln Y_{n}}{X_{n+1}-X_{n}}\\
&amp;=\frac{\ln \frac{Y_{n+1}}{Y_{n}}}{X_{n+1}-X_{n}}=  \frac{\ln (1+\frac{Y_{n+1}-Y_{n}}{Y_{n}})}{\Delta X}\\
&amp;= \frac{\ln (1+\Delta Y \% )}{\Delta X} \approx\frac{\Delta Y \% }{\Delta X}
\end{align}
$$
Sometimes researchers perform logarithmic transformation because the data exhibits a long-tailed distribution, and logarithmic transformation makes the data more compact.</p>
</div>
        </div>
    </div>
<h4 id="limitations-of-logarithmic-transformation">Limitations of Logarithmic Transformation</h4>
<p>The core conclusion of the paper is that <strong>when the data contains zeros and the scaling units change</strong> (e.g., in labor economics, hourly wages, monthly wages, and weekly wages are often used, which involves unit conversion), the estimation of logarithmic transformation will change, making it unreliable.</p>
<p>It is generally believed that the treatment effect obtained after logarithmic transformation is a percentage and is independent of the scaling parameter $\alpha$.
$$
\small
ATE=E[\log(1+aY(1))-\log(1+aY(0))]=E\left[\log\left(\frac{1+aY(1)}{1+aY(0)}\right)\right]
$$</p>
<p>Further considering the data structure, changes will occur
$$
\begin{aligned}
\lim_{a\to\infty}\log\left(\frac{1+aY(1)}{1+aY(0)}\right)=\begin{cases}\log\left(\frac{Y(1)}{Y(0)}\right)&amp;\text{if }Y(1)&gt;0,Y(0)&gt;0\\
0&amp;\text{if }Y(1)=0,Y(0)=0\\
\infty&amp;\text{if }Y(1)&gt;0,Y(0)=0\\
-\infty&amp;\text{if }Y(1)=0,Y(0)&gt;0
\end{cases}
\end{aligned}
$$
The latter three cases in the above equation show that the estimated treatment effect may be affected.</p>
<p>The paper&rsquo;s discussion on the bias of logarithmic transformation is similar to the <strong>Local Average Treatment Effect (LATE)</strong>.</p>
<p>![Taking Employment Policy as the Research Object](/img/Is the Logarithmic Transformation with Zero Values Reliable-20240523094100269.webp)</p>
<p>Taking employment policy as the object, <strong>the policy shock brings different responses to the treatment group</strong>.</p>
<blockquote>
<p>0 represents the unemployed state, and 1 represents the employed state.</p>
</blockquote>
<p>Originally, the treatment group had unemployed people 0 and employed people 1, but after the policy shock, all became employed people 1.</p>
<ul>
<li>Originally in state 1 (employed), after the shock, still in state 1 (employed), but income still increased. At this time, the change in the explanatory variable is directly brought by the policy shock, which is the <strong>intensive margin</strong>.</li>
<li>Originally in state 0, after the shock, became 1. The change in the explanatory variable is not only due to the policy shock but also due to the change in their own state, which is the <strong>extensive margin</strong>.</li>
</ul>
<p>Thus, the measurement of the treatment effect becomes the following situation:</p>
<div class="mermaid" id="id-1"></div>
<p>Therefore, the average treatment effect is also the sum of the mathematical expectations of the two marginal effects</p>
<p>$$
ATT=E(ATT^{int})+E(ATT^{ext})
$$</p>
<p>If $lg(1+x)$ is used for transformation and the units are scaled, from thousands to units</p>
<p>For the <strong>intensive margin</strong>,
$$
\begin{aligned}
ATT_{1000}^{int}&amp; =E{log(1000Y^{int}(1))-log(1000Y^{int}(0))}  \\
&amp;=E{log(1000)+logY^{int}(1))-log(1000)-logY^{int}(0))} \\
&amp;=E{log(Y^{int}(1))-log(Y^{int}(0))}=ATT^{int}
\end{aligned}
$$
For the <strong>extensive margin</strong>,</p>
<blockquote>
<p>This part is the part where the state changes from 0 to 1. After using $ln(y+1)$ for logarithmic transformation, the part that was originally 0 is still 0.</p>
</blockquote>
<p>$$
\begin{aligned}
ATT_{1000}^{ext}
&amp; =E{log(1000Y^{ext}(1))-log(1000Y^{ext}(0))}  \\
&amp;=E{log(1000)+logY^{ext}(1))-0} \\
&amp;=ATT^{ext}+\color{red}{log(1000)}
\end{aligned}
$$</p>
<p>The overall treatment effect is the sum of the mathematical expectations of the above two parts
$$
\begin{align}
ATT&amp;=P \times ATT^{ext}+(1-P)\times ATT^{int}\\
&amp;=ATT+\color{blue}{P\times log(a)}
\end{align}
$$
where $\color{blue}{P\times log(a)}$ is the biased part that changes the regression results.</p>
<p>It is because of this bias that many articles will treat zero values as part of robustness testing.</p>
<p>There are other more complex situations discussed, but I cannot understand them.</p>
<h2 id="conclusion-and-solutions">Conclusion and Solutions</h2>
<h3 id="conclusion">Conclusion</h3>
<p>When facing <strong>samples with explanatory variables containing 0</strong>!</p>
<p>Many marketing accounts exaggerate the conclusions of the article. The article criticizes the <strong>logarithmic transformation of explanatory variables containing 0</strong>. In fact, there is an impossible triangle in the estimation of treatment effects.</p>
<div class="mermaid" id="id-2"></div>
<h3 id="solutions">Solutions</h3>
<blockquote>
<p>Each of the following methods makes a trade-off in the impossible triangle.</p>
</blockquote>
<ol>
<li>Use common normalization and standardization to remove dimensions, so there is no unit effect.</li>
<li>Poisson regression maximum likelihood estimation.</li>
<li>Remove samples with zero values.</li>
<li>Clarify the sample distribution and further decompose the intensive and extensive margins.</li>
<li>Use other parameters like Lee bounds (I didn&rsquo;t understand how to do this).</li>
</ol>
<h2 id="references">References</h2>
<ul>
<li><a href="https://jiafengkevinchen.github.io/publications" target="_blank" rel="noopener noreffer ">Blog of one of the paper&rsquo;s authors</a></li>
<li><a href="https://mp.weixin.qq.com/s/linHQsAq2tXV3LXA9gNPZQ" target="_blank" rel="noopener noreffer ">Your teacher may have been teaching it wrong: You can no longer use log(Y+0.0000000001)</a></li>
<li><a href="https://mp.weixin.qq.com/s/ki4zxiqyghx89wHBSbedKA" target="_blank" rel="noopener noreffer ">TOP5 questioned for using log(1+x) data transformation, fixed effects, double difference event graphs, conclusions unreliable!</a></li>
<li><a href="https://mp.weixin.qq.com/s/3SXhDaahX54DvTlqPN6UYw" target="_blank" rel="noopener noreffer ">TOP5 latest: Do not accept log(y+1) or arcsinh(y) transformation, absolutely not!</a></li>
<li><a href="https://mp.weixin.qq.com/s/U9qwveJaFtk33CYvY1yYSQ" target="_blank" rel="noopener noreffer ">Taking logarithms: How to deal with zero and negative values</a></li>
<li><a href="https://mp.weixin.qq.com/s/LoXCQhvSqIq9EEhYj4teoA" target="_blank" rel="noopener noreffer ">The End of Logarithms</a></li>
<li><a href="https://blog.huaxiangshan.com/zh-cn/posts/effect/" target="_blank" rel="noopener noreffer ">Causal Effects</a></li>
<li><a href="https://mp.weixin.qq.com/s/4dZBIELlT4NtVwwYKdFfJw" target="_blank" rel="noopener noreffer ">Top Journal Overview: QJE The End of Logarithms</a></li>
<li><a href="https://mp.weixin.qq.com/s/U9qwveJaFtk33CYvY1yYSQ" target="_blank" rel="noopener noreffer ">How to Handle Non-Positive Values</a></li>
<li><a href="https://github.com/jiafengkevinchen/logs-public" target="_blank" rel="noopener noreffer ">Code for the log with zero paper</a></li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2024-05-12</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/en/posts/log0/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://blog.huaxiangshan.com/en/posts/log0/" data-title="Econometrics: Is the Log (y&#43;1) Transformation Reliable?" data-via="ygVNLSZ1omFBCeB" data-hashtags="Literature Review"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://blog.huaxiangshan.com/en/posts/log0/" data-hashtag="Literature Review"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://blog.huaxiangshan.com/en/posts/log0/" data-title="Econometrics: Is the Log (y&#43;1) Transformation Reliable?"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://blog.huaxiangshan.com/en/posts/log0/" data-title="Econometrics: Is the Log (y&#43;1) Transformation Reliable?"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://blog.huaxiangshan.com/en/posts/log0/" data-title="Econometrics: Is the Log (y&#43;1) Transformation Reliable?" data-image="/img/包含0值的对数化是否可靠-20240523094150322.webp"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/en/tags/literature-review/">Literature Review</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/en/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/en/posts/bff/" class="prev" rel="prev" title="Notes on Learning Calculus of Variations"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Notes on Learning Calculus of Variations</a>
            <a href="/en/posts/mycc/" class="next" rel="next" title=" Research Note 2: Miyun Wild Great Wall"> Research Note 2: Miyun Wild Great Wall<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="giscus" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://giscus.app">Giscus</a>.
            </noscript></div></article></div>
            </main><script>

(function() {
  console.log('[Music Player] Enhanced initialization script loaded');

  
  const CDN_SOURCES = [
    'https://cdn.jsdelivr.net/npm/',
    'https://unpkg.com/',
    'https://cdnjs.cloudflare.com/ajax/libs/'
  ];

  const APLAYER_CSS = 'aplayer@1.10.1/dist/APlayer.min.css';
  const APLAYER_JS = 'aplayer@1.10.1/dist/APlayer.min.js';
  const METING_JS = 'meting@2.0.1/dist/Meting.min.js';

  
  function safeHasMusicPlayers() {
    try {
      return document.querySelectorAll('meting-js').length > 0;
    } catch (e) {
      console.warn('[Music Player] Error checking for music players:', e);
      return false;
    }
  }

  function safeResourcesLoaded() {
    try {
      return typeof window.APlayer !== 'undefined' && typeof window.Meting !== 'undefined';
    } catch (e) {
      console.warn('[Music Player] Error checking resources:', e);
      return false;
    }
  }

  
  function loadResource(url, resourceType, retries = 2) {
    return new Promise((resolve, reject) => {
      const isCSS = resourceType === 'css';
      const isJS = resourceType === 'js';

      
      const existing = isCSS
        ? document.querySelector(`link[href*="${url.split('/').pop()}"]`)
        : document.querySelector(`script[src*="${url.split('/').pop()}"]`);

      if (existing) {
        console.log(`[Music Player] Resource already loaded: ${url}`);
        resolve();
        return;
      }

      const element = isCSS ? document.createElement('link') : document.createElement('script');

      if (isCSS) {
        element.rel = 'stylesheet';
        element.href = url;
      } else {
        element.src = url;
      }

      let attempts = 0;

      const attemptLoad = () => {
        attempts++;

        element.onload = () => {
          console.log(`[Music Player] Successfully loaded: ${url}`);
          resolve();
        };

        element.onerror = (err) => {
          console.warn(`[Music Player] Failed to load ${url} (attempt ${attempts}/${retries + 1})`);

          if (attempts <= retries) {
            
            const nextCDN = CDN_SOURCES.find(cdn => url.startsWith(cdn));
            if (nextCDN) {
              const nextUrl = url.replace(nextCDN, CDN_SOURCES[(CDN_SOURCES.indexOf(nextCDN) + 1) % CDN_SOURCES.length]);
              console.log(`[Music Player] Retrying with alternative CDN: ${nextUrl}`);
              if (isCSS) {
                element.href = nextUrl;
              } else {
                element.src = nextUrl;
              }
              setTimeout(attemptLoad, 500);
            } else {
              reject(err);
            }
          } else {
            reject(err);
          }
        };

        
        if (isCSS) {
          document.head.appendChild(element);
        } else {
          document.body.appendChild(element);
        }
      };

      attemptLoad();
    });
  }

  
  function loadDependencies() {
    console.log('[Music Player] Loading dependencies with fallback support...');

    
    const primaryCDN = CDN_SOURCES[0];

    return loadResource(primaryCDN + APLAYER_CSS, 'css', 1)
      .then(() => {
        console.log('[Music Player] APlayer CSS loaded');
        return loadResource(primaryCDN + APLAYER_JS, 'js', 1);
      })
      .then(() => {
        console.log('[Music Player] APlayer JS loaded');
        return loadResource(primaryCDN + METING_JS, 'js', 1);
      })
      .then(() => {
        console.log('[Music Player] All dependencies loaded successfully');
        return true;
      })
      .catch(async (err) => {
        console.error('[Music Player] Primary CDN failed, trying alternative CDNs:', err);

        
        for (let i = 1; i < CDN_SOURCES.length; i++) {
          try {
            const cdn = CDN_SOURCES[i];
            console.log(`[Music Player] Trying CDN: ${cdn}`);

            await loadResource(cdn + APLAYER_CSS, 'css', 0);
            await loadResource(cdn + APLAYER_JS, 'js', 0);
            await loadResource(cdn + METING_JS, 'js', 0);

            console.log('[Music Player] Successfully loaded from alternative CDN');
            return true;
          } catch (altErr) {
            console.warn(`[Music Player] CDN ${CDN_SOURCES[i]} failed:`, altErr);
            continue;
          }
        }

        console.error('[Music Player] All CDN attempts failed');
        return false;
      });
  }

  
  function initializePlayers() {
    try {
      if (!safeResourcesLoaded()) {
        console.error('[Music Player] Cannot initialize: dependencies not loaded');
        return false;
      }

      console.log('[Music Player] Initializing meting-js players...');
      let successCount = 0;
      let errorCount = 0;

      const players = document.querySelectorAll('meting-js');

      players.forEach(el => {
        try {
          if (el.hasAttribute('data-initialized')) {
            console.log('[Music Player] Player already initialized, skipping');
            return;
          }

          
          if (typeof window.Meting !== 'function') {
            throw new Error('Meting constructor not available');
          }

          new window.Meting(el);
          el.setAttribute('data-initialized', 'true');
          successCount++;
          console.log('[Music Player] Successfully initialized meting-js element');
        } catch (err) {
          errorCount++;
          console.error('[Music Player] Error initializing meting-js element:', err);
        }
      });

      console.log(`[Music Player] Initialization complete: ${successCount} successful, ${errorCount} failed`);

      
      if (successCount === 0 && players.length > 0) {
        console.log('[Music Player] No players initialized, scheduling retry...');
        setTimeout(() => {
          console.log('[Music Player] Retrying initialization...');
          initializePlayers();
        }, 1000);
      }

      return successCount > 0;
    } catch (error) {
      console.error('[Music Player] Fatal error during initialization:', error);
      return false;
    }
  }

  
  function initMusicPlayers() {
    console.log('[Music Player] Initialization triggered');

    try {
      if (!safeHasMusicPlayers()) {
        console.log('[Music Player] No meting-js elements found');
        return;
      }

      const playerCount = document.querySelectorAll('meting-js').length;
      console.log(`[Music Player] Found ${playerCount} meting-js element(s)`);

      
      if (safeResourcesLoaded()) {
        console.log('[Music Player] Resources already loaded, initializing...');
        setTimeout(() => initializePlayers(), 50);
        return;
      }

      
      const scripts = Array.from(document.querySelectorAll('script[src]'));
      const hasAPlayerScript = scripts.some(s => s.src.includes('APlayer.min.js'));
      const hasMetingScript = scripts.some(s => s.src.includes('Meting.min.js'));

      if (hasAPlayerScript || hasMetingScript) {
        console.log('[Music Player] Resources detected in DOM, waiting for load...');
        waitForResources();
        return;
      }

      
      console.log('[Music Player] Loading dependencies dynamically...');
      loadDependencies().then(success => {
        if (success) {
          console.log('[Music Player] Dependencies loaded, initializing players...');
          setTimeout(() => initializePlayers(), 100);
        } else {
          console.error('[Music Player] Failed to load dependencies, will retry in 2s');
          setTimeout(initMusicPlayers, 2000);
        }
      });
    } catch (error) {
      console.error('[Music Player] Error in initialization flow:', error);
    }
  }

  
  function waitForResources() {
    const maxWaitTime = 10000; 
    const checkInterval = 250;
    let elapsed = 0;
    let timeoutId = null;

    const check = () => {
      elapsed += checkInterval;

      if (safeResourcesLoaded()) {
        console.log(`[Music Player] Resources loaded after ${elapsed}ms`);
        setTimeout(() => initializePlayers(), 50);
        return;
      }

      if (elapsed >= maxWaitTime) {
        console.warn('[Music Player] Timeout waiting for resources, loading dynamically...');
        loadDependencies().then(success => {
          if (success) {
            setTimeout(() => initializePlayers(), 100);
          }
        });
        return;
      }

      timeoutId = setTimeout(check, checkInterval);
    };

    check();
  }

  
  function startInitialization() {
    
    setTimeout(initMusicPlayers, 100);
  }

  
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
      console.log('[Music Player] DOMContentLoaded event fired');
      startInitialization();
    });
  } else {
    console.log('[Music Player] DOM already loaded');
    startInitialization();
  }

  
  if (typeof document.addEventListener === 'function') {
    document.addEventListener('pjax:end', function() {
      console.log('[Music Player] PJAX navigation detected');
      setTimeout(initMusicPlayers, 100);
    });
  }

  
  document.addEventListener('visibilitychange', function() {
    if (!document.hidden) {
      setTimeout(() => {
        if (document.querySelectorAll('meting-js').length > 0 && !safeResourcesLoaded()) {
          console.log('[Music Player] Page visible again, checking music players...');
          initMusicPlayers();
        }
      }, 500);
    }
  });

  
  window.initMusicPlayers = initMusicPlayers;
  console.log('[Music Player] Initialization system ready');
})();
</script>



    
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-line">
                <span id="run-time" data-i18n="runtime"></span>
            </div><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreferrer" title="Hugo 0.122.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreferrer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div>

            <div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2024 - 2026</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/hzp2333/hzp2333.github.io" target="_blank">滑翔闪</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span>
            </div>

            <style>
                .footerImg {
                    height: 20px;
                }
            </style>
            <div class="footer-line custom">
                <a href="https://icp.gov.moe/?keyword=20244204" target="_blank">萌ICP备20244204号</a>
                <a style="text-decoration:none;color:#55bb8a;" href="https://travel.moe/go.html" title="异次元之旅-跃迁-我们一起去萌站成员的星球旅行吧！" target="_blank">
                    <img src="https://travel.moe/images/icon/icon64green.png" style="width:24px;height:24px" alt="异次元之旅">异次元之旅
                </a>
            </div>

            <div class="footer-line custom">
                <a href="https://www.travellings.cn/go.html" target="_blank">
                    <img src="https://www.travellings.cn/assets/logo.gif" class="footerImg" alt="开往-友链接力 v1.5" title="开往-友链接力 v1.5">
                </a>
                <a href="https://www.foreverblog.cn/" target="_blank">
                    <img src="https://foreverblog.cn/assets/logo/logo_en_default.png" class="footerImg" alt="Forever Blog">
                </a>
                <a href="https://www.foreverblog.cn/go.html" target="_blank">
                    <img src="https://foreverblog.cn/assets/logo/wormhole_2.gif" class="footerImg" alt="穿梭虫洞-随机访问十年之约友链博客" title="穿梭虫洞-随机访问十年之约友链博客">
                </a>
            </div><div class="footer-line">
  <i class="fas fa-book fa-fw" aria-hidden="true"></i>&nbsp;56 posts, 88641 words total</div>
    
        
        <script async src=" //busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js "></script>
    

    
        
            <section>
                
                    <span id="busuanzi_container_value_site_pv"><i class="far fa-eye fa-fw"></i>
                        
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                

                
                    &nbsp;|&nbsp;              
                

                
                    <span id="busuanzi_container_value_site_uv"><i class="fa fa-user"></i>
                        
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
            </section>
        

        
        
    


</div>
    </footer>
 

    
    <script src="https://cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js" 
        data-color="0,0,0" 
        data-count="150" 
        data-zIndex="-1">
    </script>
</body>
</html>



</div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.zh.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mermaid@9.1.3/dist/mermaid.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{"giscus":{"category":"Announcements","categoryId":"DIC_kwDOLbBjxM4Cdr0n","darkTheme":"dark_dimmed","emitMetadata":"0","inputPosition":"bottom","lang":"en","lazyLoading":false,"lightTheme":"light","mapping":"pathname","reactionsEnabled":"1","repo":"hzp2333/Giscus","repoId":"R_kgDOLbBjxA"}},"data":{"id-1":" graph LR\n A(Exogenous Policy Shock 01 Variable Z)--Treatment Group--\u003eC{01 Object Response}\n C{Object Response D}--extensive margin--\u003eD(State from 0 to 1)\n C{Object Response D}--intensive margin--\u003eE(State from 1 to 1)\n D(State from 0 to 1)--\u003eF{Explanatory Variable}\n E(State from 1 to 1)--\u003eF{Explanatory Variable}","id-2":"graph LR\nA(Estimate Individual Average Treatment Effect)------B(Treatment Effect Remains Unchanged After Unit Transformation)\nB(Treatment Effect Remains Unchanged After Unit Transformation)------ C(Point Identification Based on Marginal Distribution of Potential Outcomes)\nC(Point Identification Based on Marginal Distribution of Potential Outcomes)------A(Estimate Individual Average Treatment Effect)","id-3":"HXS'S BLOG","id-4":"HXS'S BLOG"},"lightgallery":true,"search":{"highlightTag":"em","lunrIndexURL":"/en/index.json","lunrLanguageCode":"en","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"No results found","snippetLength":50,"type":"lunr"},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-3":["id-3"],"id-4":["id-4"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery@2.1.3/dist/jquery.min.js"></script><script type="text/javascript" src="/js/custom.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-CYZVM6VVZ8', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-CYZVM6VVZ8" async></script></body>
</html>
